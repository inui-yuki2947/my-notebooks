# プロセス管理

## ps, pstree

### コマンド

|コマンド|概要|
|---|---|
|`ps`|現在動作しているプロセスを表示する。|
|`pstree [プロセスIDまたはユーザー名]`|現在動作しているプロセスについて、階層構造を分かりやすく表示する。<br />（`ps f`コマンドと同じ）|

### オプション（`ps`）

| オプション | 概要                                               |
| ---------- | -------------------------------------------------- |
| `a`        | 全てのユーザーのプロセスを表示する。               |
| `x`        | 実行端末のないプロセスを表示する。                 |
| `-e`       | 全てのプロセスを表示する。（`ax`オプションと同じ） |
| `u`        | 実行ユーザー名などを表示する。                     |
| `l, -l`    | 親プロセスのPID（PPID）やナイス値も表示する。      |
| `f`        | 階層構造を分かりやすく表示する。                   |

### その他

- プロセスは、PID、及びプロセスを開始したユーザーから引き継がれたUIDとGIDを持つ。

## pgrep

### コマンド

| コマンド           | 概要                                        |
| ------------------ | ------------------------------------------- |
| `pgrep プロセス名` | 指定したプロセス名に対応するPIDを表示する。 |

## lsof

### コマンド

|コマンド|概要|
|---|---|
|`lsof [パス名]`|**現在開いているファイル一覧**を表示する。|

### オプション

| オプション       | 概要                               |
| ---------------- | ---------------------------------- |
| `-i :ポート番号` | ポート番号やプロトコルを指定する。 |
| `-p プロセスID`  | プロセスIDを指定する。             |
| `-P`             | ポート番号を数字で表示する。       |

### 例

- 接続を受け付けているポートに絞り込む場合

  ```bash
  lsof -p プロセスID | grep LISTEN
  ```

## top, iotop

### コマンド

| コマンド | 概要                                                         |
| -------- | ------------------------------------------------------------ |
| `top`    | 現在実行中のプロセスを継続的に表示する。<br />（BSDとGNUで結構挙動が違う） |
| `iotop`  | I/O情報を継続的に表示する。                                  |

### コマンド内コマンド（`top`）

| コマンド            | 概要                 |
| ------------------- | -------------------- |
| `スペース`, `Enter` | 表示を更新する。     |
| `f`                 | 表示項目を変更する。 |
| `q`                 | 終了する。           |

## uptime

### コマンド

| コマンド | 概要                                                         |
| -------- | ------------------------------------------------------------ |
| `uptime` | システムの稼働時間や平均負荷を表示する。<br />（`top`コマンドの1行目とほぼ同じ） |

## vmstat, iostat

### コマンド

| コマンド                       | 概要                                  |
| ------------------------------ | ------------------------------------- |
| `vmstat [表示間隔秒数 [回数]]` | メモリの詳細な情報を表示する。        |
| `iostat [表示間隔秒数 [回数]]` | CPUとディスク入出力の情報を表示する。 |

## sar

### コマンド

| コマンド                    | 概要                                         |
| --------------------------- | -------------------------------------------- |
| `sar [表示間隔秒数 [回数]]` | 様々なシステム統計情報の**ログ**を表示する。 |

### オプション

| オプション | 概要                                         |
| ---------- | -------------------------------------------- |
| `-A`       | 全ての項目を表示する。                       |
| `-b`       | ディスクの入出力と転送レート情報を表示する。 |
| `-n DEV`   | ネットワーク関連の情報を表示する。           |
| `-n EDEV`  | ネットワーク関連のエラー情報を表示する。     |
| `-r`       | メモリとスワップ関連の情報を表示する。       |
| `-u`       | CPU関連の情報を表示する。（デフォルト）      |

## sadf

### コマンド

| コマンド | 概要                                           |
| -------- | ---------------------------------------------- |
| `sadf`   | sadcによるログを、TSV形式やXML形式で出力する。 |

## fuser

### コマンド

|コマンド|概要|
|---|---|
|`fuser 名前...`|ファイルやソケットを使用しているプロセスを表示する。|

### オプション

| オプション                 | 概要                                         |
| -------------------------- | -------------------------------------------- |
| `-n, --namespace 名前空間` | `file, udp, tcp`といった名前空間を指定する。 |
| `-u`                       | ユーザー名を表示する。                       |
| `-k`                       | プロセスにシグナル`KILL`を送る。             |

## free

### コマンド

|コマンド|概要|
|---|---|
|`free`|メモリの利用状況、空き状況を表示する。|

### オプション

|オプション|概要|
|---|---|
|`-m`|MB単位で表示する。|

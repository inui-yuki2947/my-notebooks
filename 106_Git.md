# Git
## 共通
### ドキュメント
- [Git - Reference](https://git-scm.com/docs)

### 作業スペース
- ワークツリー（ワーキングツリー）
  - 今作業している場所
  - 変更分は**赤色**で表示
- インデックス
  - リポジトリにコミットするファイルがある場所
  - 変更分は**緑色**で表示
- リポジトリ
  - Gitで履歴が管理された場所

### ブランチ
- [GitのHEADとは何者なのか - Qiita](https://qiita.com/ymzk-jp/items/00ff664da60c37458aaa)
- Gitにおけるブランチは、単にコミットを指す軽量なポインタに過ぎない。
- ブランチ・タグ名は、コミットIDのエイリアスである。
- 「detached HEAD」とは、HEADがブランチを指していない状態のことである。

### チルダとキャレット
- [【やっとわかった！】gitのHEAD^とHEAD~の違い - Qiita](https://qiita.com/chihiro/items/d551c14cb9764454e0b9)
- `~n`は、親1つ目をn世代遡ったものを表す。
  - `HEAD~`：親1つ目
  - `HEAD~~`：親1つ目の親1つ目
  - `HEAD~2`：親1つ目の親1つ目
- `^n`は、複数親がいる場合に、n番目の親を表す。（マージコミットを遡りたい場合などに使う）
  - `HEAD^`：親1つ目
  - `HEAD^^`：親1つ目の親1つ目
  - `HEAD^2`：親2つ目
  - `HEAD^2^`：親2つ目の親1つ目

## リポジトリ操作
### remote
- `remote`コマンドは、リモートリポジトリの名前を表示する。
  ```bash
  git remote
  ```
- `-v`オプションで、fetchとpullそれぞれについて、URLも合わせて表示する。

### remote add
- `remote add`コマンドは、リモートリポジトリを追加する。
  ```bash
  git remote add リポジトリ リポジトリURL
  ```

### remote remove
- `remote remove`コマンドは、リモートリポジトリを削除する。
  ```bash
  git remote remove リポジトリ
  ```

### remote prune
- `remote prune`コマンドは、消え残っているリモートブランチを削除する。
  ```bash
  git remote prune リポジトリ
  ```

### clone
- `clone`コマンドは、リモートリポジトリをローカルリポジトリに複製する。
  ```bash
  git clone リポジトリURL
  ```

### fork
- `fork`コマンドは、リモートリポジトリを自分のアカウントの**リモートリポジトリ**にコピーする。

## コミット操作
### log
- `log`コマンドは、コミット履歴を表示する。
- `--oneline`オプションで、ログを一行で表示させる。

### show
- `show`コマンドは、コミット詳細を表示する。
  ```bash
  git show [コミット（デフォルトはHEAD）]
  ```

### add
- `add`コマンドは、指定したファイルをインデックスに追加（ステージ）する。
  ```bash
  git add ファイル
  ```

### rm
- `rm`コマンドは、ワークツリー・インデックスから、ファイルを削除する。
  ```bash
  git rm ファイル
  ```
- `--cached`オプションで、インデックスからのみ、ファイルを削除できる。

### commit
- `commit`コマンドは、インデックスにあるものをコミットする。
- `-m メッセージ`オプションで、コミットメッセージを指定できる。
- `-a`オプションで、管理対象ファイルが全て`add`されコミットされる。（管理対象外ファイルは、先に`add`を行っておく必要がある）

### revert
- `revert`コマンドは、コミットを打ち消す。
  ```bash
  git revert 打ち消したいコミット
  ```
- `--mainline, -m <parent-number>`オプションで、マージコミットを打ち消すことができる。[GitでMerge CommitをRevertする方法 - Qiita](https://qiita.com/awakia/items/5fad0c454ddc7b478ff1)
  - `<parent-number>`は、`1`がマージされた側のブランチ、`2`がマージする側のブランチ。（なので基本的には`1`を指定する）

## ブランチ・タグ操作
### branch
- `branch`コマンドは、ブランチ一覧を表示する。
  ```bash
  git branch
  ```
- `-a`オプションで、リモートブランチも表示する。
- `-v`オプションで、詳細情報を表示する。
- `-vv`オプションで、更に上流ブランチの情報も表示する。
- `--merged [コミット（省略時はHEAD）]`オプションで、指定したコミットにマージ済みのブランチのみ表示する。

### branch ブランチ名
- `branch ブランチ名`コマンドは、ブランチを作成する。
  ```bash
  git branch ブランチ名 [派生元コミット（省略時はHEAD）]
  ```
- 派生元コミットでリモートブランチを指定すると、それが上流ブランチとなる。

### tag
- `tag`コマンドは、タグ一覧を表示する。
  ```bash
  git tag
  ```

### tag タグ名
- `tag タグ名`コマンドは、タグを作成する。
  ```bash
  git tag タグ名 [タグを付けるコミット（省略時はHEAD）]
  ```

### checkout
- [Git の Reset, Checkout, Revert の違い - yu8mada](https://yu8mada.com/2018/06/01/the-difference-between-reset-checkout-and-revert-in-git/)
- `checkout`コマンドは、ブランチ・ワークツリー・インデックスを変更する。
- コミットのみ指定した場合
  ```bash
  git checkout コミット
  ```
  - 引数でローカルブランチを指定した場合、そのブランチに切り替わる。
  - 引数でローカルブランチ以外を指定した場合、「detached HEAD」状態となる。
  - 未コミットの変更があればエラーとなる。
- `-b 新しいブランチ`オプションを使用した場合
  ```bash
  git checkout -b 新しいブランチ [派生元コミット（省略時はHEAD）]
  ```
  - 新しいブランチを作成してチェックアウトする。
  - 派生元コミットでリモートブランチを指定すると、それが上流ブランチとなる。
- ファイルを指定した場合
  ```bash
  git checkout [コミット（省略時はHEAD）] ファイル
  ```
  - ファイルのみ指定した場合、ワークツリーがインデックスの状態となる。
  - コミット・ファイルを指定した場合、ワークツリー・インデックスが、指定したコミットのファイルの状態となる。

### reset
- `reset`コマンドは、ブランチを変更せず、（ワークツリー・）インデックスを変更する。
- ファイルを指定しなかった場合
  ```bash
  git reset [コミット（省略時はHEAD）]
  ```
  - HEADは、指定したコミットに移動する。
  - `--soft`オプションは、ワークツリー・インデックスを変更しない。
  - `--mixed`オプションは、ワークツリーは変更せず、インデックスを変更する。（デフォルト）
  - `--hard`オプションは、ワークツリー・インデックスを変更する。
- ファイルを指定した場合
  ```bash
  git reset [コミット（省略時はHEAD）] ファイル
  ```
  - インデックスは、指定したコミットのファイルの状態となる。
  - `git reset ファイル`と`git add ファイル`は、逆の操作である。

## マージ・リベース
### merge
- `merge`コマンドは、コミットをマージする。
  ```bash
  git merge [マージするコミット（省略時は上流ブランチ）]
  ```
-  `--no-edit`オプションで、メッセージの編集を省略できる。

### rebase
- `rebase`コマンドは、コミットをリベースする。
  ```bash
  git rebase [リベースするコミット（省略時は上流ブランチ）]
  ```
- `-i`オプションで、対話的にリベースを行うことができる。
- `--autosquash`オプションで、メッセージに`fixup!`を付けたコミットを`fixup`とできる。

## リモートブランチ・タグ操作
### fetch
- `fetch`コマンドは、リモートブランチ・タグを更新する。
  ```bash
  git fetch [リポジトリ [<refspec>]]
  ```
- 引数省略時は、HEADの上流ブランチのリポジトリ、または`origin`の、全ブランチ・タグを更新する。
- 第1引数でリポジトリを指定すると、そのリポジトリの全ブランチ・タグを更新する。
- 第2引数でブランチ・タグを指定すると、更新対象をそれに限定できる。

### pull
- `pull`コマンドは、リモートブランチ・タグを更新した後、それをHEADにマージする。
（`fetch` + `merge FETCH_HEAD`である）
  ```bash
  git pull [リポジトリ [<refspec>]]
  ```
- 引数省略時は、HEADの上流ブランチを更新した後、それをHEADにマージする。
- 第1引数でリポジトリを指定すると、そのリポジトリでの上流ブランチを更新した後、それをHEADにマージする。
- 第2引数でブランチ・タグを指定すると、そのブランチ・タグを更新した後、それをHEADにマージする。
- `--prune`オプションで、リモートで削除されたブランチを削除する。

### push
- `push`コマンドは、リモートリポジトリの指定したブランチ・タグを、ローカルの状態へ更新する。
  ```bash
  git push [リポジトリ [<refspec>]]
  ```
- `-u`オプションで、今回指定するブランチを上流ブランチとして設定する。
- `--tags`オプションで、全タグをプッシュする。

### refspec
- TODO あとで調べる

## submodule
### 概要
- `submodule`コマンドは、サブモジュール一覧を表示する。

### update
- `sudmodule update`コマンドで、サブモジュールを親で指定したコミットに更新する。

## その他操作
### diff
- `diff`コマンドは、ファイルの差分を確認できる。
  ```bash
  git diff コミット1..コミット2
  ```
- `--name-only`オプションで、ファイル名のみ表示する。

### clean
- `clean`コマンドは、管理対象外のファイルを削除する。
  ```bash
  git clean [パス（省略時はカレントディレクトリ）]
  ```
- `-f, --force`オプションで、削除を確定できる。
- `-n, --dry-run`オプションで、ドライランできる。
- `-d`オプションで、ディレクトリも含めて削除する。

## gitignore
- `.gitignore`ファイルには、Git管理に含めないファイルを記述する。
- 値がスラッシュから始まらない場合、全サブディレクトリの同名ファイル・ディレクトリが除外される。
- あとからgitignoreを追加する場合は、`git rm --cached`を行う必要がある。<br>
ただしその場合、それをプルした他ユーザーは、そのファイルが消えてしまう。<br>
[.gitignoreを後から設定し、git管理から除外する方法 - Qiita](https://qiita.com/yutosa3/items/25ab031c8061e8c9a4c4)


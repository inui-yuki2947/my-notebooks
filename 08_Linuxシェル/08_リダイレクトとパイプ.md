# リダイレクトとパイプ

## 共通

### ファイルディスクリプタ

- `0,1,2`はそれぞれ、標準入力・標準出力・標準エラー出力を表す。

### リダイレクト

- `n>&m`で、n番のリダイレクトをm番にすることができる。

- `1>`の`1`は省略可能である。

- リダイレクトの変更は、記述した順に行われる。（順不同ではない）

- 例

  | 記法                                                   | 概要                                                         |
  | ------------------------------------------------------ | ------------------------------------------------------------ |
  | `コマンド 2>&1`                                        | 標準エラー出力を、標準出力に出力する。                       |
  | `コマンド 2>&1 > ファイル`                             | 標準エラー出力を標準出力に出力し、標準出力をファイルに出力する |
  | `コマンド > ファイル 2>&1`<br />`コマンド &> ファイル` | 標準出力・エラー出力を、まとめてファイルに出力する           |

### パイプライン

- 例

  | 記法                       | 概要                                                         |
  | -------------------------- | ------------------------------------------------------------ |
  | `コマンド 2>&1 ｜ コマンド` | 標準出力・エラー出力を、まとめてパイプする。                 |
  | `コマンド ｜& コマンド`     | 標準出力・エラー出力を、まとめてパイプする。（省略記法、BSDでは使えない？） |

### ヒアドキュメント

- ヒアドキュメントの内容は、コマンドの**標準入力**として実行される。

  ```bash
  コマンド << 終了文字列
    内容
  終了文字列
  ```

- 終了文字列としては、`EOF`などがよく使われる。
- ヒアドキュメントの内側では各種展開が行われるが、
  展開をさせたくない場合は、`<< 'EOF'`など、終了文字列をクォートする。

### ヒアストリング

- 書式

  ```bash
  コマンド <<< 文字列
  ```

## コマンド

### tee

- コマンド

  |コマンド|概要|
  |---|---|
  |`tee [ファイル名...]`|標準入力を、標準出力とファイルに出力する。|

- オプション

  |オプション|概要|
  |---|---|
  |`-a`|ファイルに上書きでなく追記する。|

- 複数ファイルに同じ内容を出力したいときに有用である。

### xargs

- コマンド

  |コマンド|概要|
  |---|---|
  |`xargs コマンド`|標準入力を、指定したコマンドの引数として渡す。|

- オプション

  | オプション      | 概要                                                   | 例                                             |
  | --------------- | ------------------------------------------------------ | ---------------------------------------------- |
  | `-I 置換文字列` | 引数を任意の位置に挿入できる。（`{}`などをよく使う？） | `xargs -I {} コマンド 引数 {}`                 |
  | `-0`            | ヌル文字を区切り文字として扱う。                       | `find . -name '*.txt' -print0 ｜ xargs -0 ls` |

- 引数をコマンド置換で指定する場合と比べ、引数が長くなる場合にも対応できるという利点がある。

- 標準入力が空であった場合
  - BSD系では、コマンドは実行されない。（終了ステータスは0）
  - GNU系では、コマンドは実行される。（`--no-run-if-empty`オプションで、実行させないようにできる）

## その他

### ハイフン

- `cat, diff, vim, wget`コマンドで、`-`を引数に渡すと、標準入出力として扱われる。
  [git, cd, su, cat, diff, vim...-(ハイフン)でできること@コマンドライン - Qiita](https://qiita.com/ryosukes/items/b9a3b2913f72e1127e58#cat-diff-vim-wget%E3%81%A7%E3%83%8F%E3%82%A4%E3%83%95%E3%83%B3%E3%82%92%E5%BC%95%E6%95%B0%E3%81%AB%E6%B8%A1%E3%81%99%E3%81%A8)

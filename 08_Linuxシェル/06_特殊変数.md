# 特殊変数

## 位置パラメータ

### 概要

- 位置パラメータ

  | 記法         | 概要                                                         |
  | ------------ | ------------------------------------------------------------ |
  | `$n`, `${n}` | n番目の引数<br />10個目以降は`${10}`のように記述する必要がある。 |
  | `$#`         | 引数の数                                                     |
  | `$@`         | 引数をスペースで連結した文字列                               |
  | `$*`         | 引数を区切り文字で連結した文字列                             |

### set, shift

- コマンド

  |コマンド|概要|
  |---|---|
  |`set 引数...`|位置パラメータを上書き設定する。|
  |`shift [ずらす数（省略時は1）]`|位置パラメータの番号を前にずらす。|

### getopts

- コマンド

  | コマンド                                          | 概要                                                         |
  | ------------------------------------------------- | ------------------------------------------------------------ |
  | `getopts 短いオプションとなる文字列 代入先の変数` | 呼び出す度に位置パラメータを順に解析し、解析結果を変数に代入する。 |

- 次に解析を行うインデックス（1始まり）は、変数`OPTIND`に代入される。

- オプション解析が終わった後に、`$OPTIND - 1`の分だけ位置パラメータを`shift`するとよい。

  ```bash
  shift $((OPTIND - 1))
  ```

- 短いオプション文字の後に`:`をつけると、引数を取るオプションとして解析し、その値は変数`OPTARG`に代入される。

- オプションが見つからない場合は、終了ステータス`1` を返す。

- 不正なオプションが指定された、あるいはオプション引数が必要なのに指定されなかった場合は、変数に`?` が代入される。

- 例

  ```bash
  while getopts ab: opt; do
    case $opt in
      a) 処理1;;
      b) 処理2;;
      *) exit 1;;
    esac
  done
  ```

### getopt

- コマンド

  | コマンド                                            | 概要                                                   |
  | --------------------------------------------------- | ------------------------------------------------------ |
  | `getopt [-o] 短いオプション文字列 解析したい文字列` | 文字列を解析し、オプション・引数に分けて標準出力する。 |

- 短いオプション文字の後に`:`をつけると、引数を取るオプションとして解析する。

- 例

  ```bash
  getopt ab:c -a -b hoge -c fuga
  ```

- `getopt`は高機能であるが外部コマンドであるため、環境を選ばず利用したい場合は`getopts`を利用するとよい。

## その他特殊変数

### 概要

- その他特殊変数

  | 記法 | 概要                                       |
  | ---- | ------------------------------------------ |
  | `$0` | 起動したシェルスクリプトの名前             |
  | `$$` | 現在のシェルのプロセスID                   |
  | `$!` | バックグラウンドで実行した直前のプロセスID |
  | `$?` | 直前に実行したコマンドの終了ステータス     |

### exit, return

- コマンド

  | コマンド                  | 概要                                                 |
  | ------------------------- | ---------------------------------------------------- |
  | `exit [終了ステータス]`   | **シェルスクリプト全体**の終了ステータスを指定する。 |
  | `return [終了ステータス]` | **関数**の終了ステータスを指定する。                 |

- 終了ステータス省略時は、`0`となる。

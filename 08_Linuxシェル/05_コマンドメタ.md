# コマンドメタ

## ライブラリ

### 静的ライブラリと共有ライブラリ

- 比較表

  |項目|リンク|読み込みタイミング|拡張子（Linux）|拡張子（Windows）|
  |---|---|---|---|---|
  |静的ライブラリ|スタティックリンク|コンパイル時|`.a`|`.lib`|
  |共有ライブラリ|ダイナミックリンク|実行時|`.so` (Shared Object)|`.dll` (Dynamic Link Library)|

### 共有ライブラリの読み込み順

1. 環境変数`LD_LIBRARY_PATH`
1. `/etc/ld.so.cache`ファイル
1. `/lib, /usr/lib`ディレクトリ

### ldd, ldconfig

- コマンド

  |コマンド|概要|
  |---|---|
  |`ldd 実行ファイル名`|実行ファイルが必要としている共有ライブラリを表示する。<br />PATHは考慮されない。|
  |`ldconfig`|`/etc/ld.so.conf`ファイルをもとに、`/etc/ld.so.cache`ファイルを生成する。|

## 実行されるコマンド

### 内部コマンドと外部コマンド

- 比較表

  | 種類         | 概要                                     | 例             | マニュアル |
  | ------------ | ---------------------------------------- | -------------- | ---------- |
  | 内部コマンド | シェル自体に埋め込まれたコマンド         | `cd`, `echo`   | `help`     |
  | 外部コマンド | 独立したプログラムとして存在するコマンド | `find`, `gzip` | `man`      |

### コマンドの優先順位

1. エイリアス
2. 内部コマンド
3. PATH

### PATH

- 環境変数`PATH`は、コロン区切りでディレクトリを指定する。
- 左側から優先して検索される。
- サブディレクトリは検索されない。

### type, which, whereis

- コマンド

  | コマンド           | 概要                                                         |
  | ------------------ | ------------------------------------------------------------ |
  | `type コマンド`    | **実行されるコマンド**を表示する。                           |
  | `which コマンド`   | コマンドが**PATHのどこにあるか**を表示する。                 |
  | `whereis コマンド` | コマンドのバイナリファイル・ソースコード・マニュアルファイルが置かれている場所を表示する。 |

### builtin, command

- コマンド

  | コマンド           | 概要                                               |
  | ------------------ | -------------------------------------------------- |
  | `builtin コマンド` | 内部コマンドから、コマンドを探して実行する。       |
  | `command コマンド` | 内部コマンドとPATHから、コマンドを探して実行する。 |

## エイリアス

### alias, unalias

- コマンド

  | コマンド                      | 概要                                 |
  | ----------------------------- | ------------------------------------ |
  | `alias`                       | コマンドのエイリアス一覧を表示する。 |
  | `alias エイリアス名=コマンド` | コマンドのエイリアスを登録する。     |
  | `unalias エイリアス名`        | コマンドのエイリアスを削除する。     |
  | `unalias -a`                  | コマンドのエイリアスを全て削除する。 |

### エイリアスの無視

- コマンド名の1文字目がクォートされていると、エイリアスは適用されない。

  ```bash
  \コマンド
  ```

## マニュアル

### help

- コマンド

  |コマンド|概要|
  |---|---|
  |`help キーワード`|内部コマンドのマニュアルを表示する。|

### man

- コマンド

  | コマンド                      | 概要                                           |
  | ----------------------------- | ---------------------------------------------- |
  | `man [セクション] キーワード` | コマンドやファイルなどのマニュアルを表示する。 |
  
- セクション

  | セクション | 概要                 |
  | ---------- | -------------------- |
  | `1`        | ユーザーコマンド     |
  | `5`        | 設定ファイル         |
  | `8`        | システム管理コマンド |

- オプション

  |オプション|概要|
  |---|---|
  |`-a`|全てのセクションを表示する。（未指定時は、最初に見つかったセクションのみ表示する）|
  |`-f`|`whatis`コマンドと同じ。|
  |`-k`|`apropos`コマンドと同じ。|

### whatis, apropos

- コマンド

  | コマンド             | 概要                                                         |
  | -------------------- | ------------------------------------------------------------ |
  | `whatis キーワード`  | コマンドの簡易的な説明（NAME）を表示する。（**コマンド名**を検索） |
  | `apropos キーワード` | コマンドの簡易的な説明（NAME）を表示する。（**コマンド名または概要**を検索） |

## コマンド実行

### bash

- コマンド

  |コマンド|概要|
  |---|---|
  |`bash [ファイル]`|**子プロセス**で、指定したファイルまたは標準入力のコマンドを実行する。|

- オプション

  | オプション          | 概要                             |
  | ------------------- | -------------------------------- |
  | `-c コマンド文字列` | 文字列をコマンドとして実行する。 |

### source

- コマンド

  | コマンド                                                | 概要                                                         |
  | ------------------------------------------------------- | ------------------------------------------------------------ |
  | `. ファイル [引数...]`<br />`source ファイル [引数...]` | **カレントシェル**で、指定したファイルにあるコマンドを実行する。 |

### eval

- コマンド
  
  | コマンド              | 概要                                                   |
  | --------------------- | ------------------------------------------------------ |
  | `eval コマンド文字列` | **カレントシェル**で、文字列をコマンドとして実行する。 |
  
- `eval`コマンドは、変数にコマンド文字列を代入して実行したい場合や、**パイプやリダイレクトを含む場合**に使用する。
  （それ以外の場合は、変数をそのまま書いて実行すればよい）
  [技術メモメモ: シェルスクリプトで変数に入れたコマンドを実行する方法の比較(evalコマンドなどの動作比較)](https://tech-mmmm.blogspot.com/2017/11/eval.html)

### exec

- コマンド

  | コマンド                  | 概要                                                     |
  | ------------------------- | -------------------------------------------------------- |
  | `exec コマンド [引数...]` | **現在のプロセス**で、引数で指定したコマンドを実行する。 |

## コマンド履歴

### コマンド履歴のフロー

1. Bash起動時に、`~/.bash_history`から読み込まれる。
1. Bash使用中は、キャッシュが使用される。
1. Bash終了時に、`~/.bash_history`に書き込まれる。

### 環境変数

- 比較表

  | 環境変数       | 概要                             | デフォルト値      |
  | -------------- | -------------------------------- | ----------------- |
  | `HISTFILE`     | コマンド履歴を記録するファイル。 | `~/.bash_history` |
  | `HISTSIZE`     | シェルのコマンド履歴での保存数   |                   |
  | `HISTFILESIZE` | コマンド履歴ファイルでの保存数   |                   |

### history

- コマンド

  |コマンド|概要|
  |---|---|
  |`history`|コマンド履歴を表示する。|

- オプション

  | オプション          | 概要                           |
  | ------------------- | ------------------------------ |
  | `-d 削除したい番号` | 特定のコマンド履歴を削除する。 |
  | `-c`                | 全コマンド履歴を削除する。     |
  | `-w [ファイル名]`   | ファイルに上書きする。         |
  | `-r [ファイル名]`   | ファイルから上書きする。       |
  | `-a [ファイル名]`   | ファイルに追記する。           |
  | `-n [ファイル名]`   | ファイルから追記する。         |

## その他

### complete

- `complete`コマンドは、任意のコマンドに対して補完の動作を定義する。

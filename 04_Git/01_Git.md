# Git

## 共通

### ドキュメント

- [Git - Book](https://git-scm.com/book/ja/v2)

### 作業スペース

- 作業スペース

| 種類                             | 概要                                       | 表示色 |
| -------------------------------- | ------------------------------------------ | ------ |
| ワークツリー（ワーキングツリー） | 今作業している場所                         | 赤色   |
| インデックス                     | リポジトリにコミットするファイルがある場所 | 緑色   |
| リポジトリ                       | Gitで履歴が管理された場所                  |        |

## ファイル操作

### add, reset

- コマンド

| コマンド             | 概要                                   |
| -------------------- | -------------------------------------- |
| `git add ファイル`   | 指定したファイルを、ステージする。     |
| `git reset ファイル` | 指定したファイルを、アンステージする。 |

- オプション（`add`）

| オプション            | 概要                                 |
| --------------------- | ------------------------------------ |
| `-N, --intent-to-add` | ファイルを管理対象に含めるのみ行う。 |

## コミット

### commit

- コマンド

|コマンド|概要|
|---|---|
|`git commit [ファイル名...]`|インデックスにあるものをコミットする。|

- オプション
  
| オプション                 | 概要                                                         |
| -------------------------- | ------------------------------------------------------------ |
| `-a`                       | 管理対象ファイルが全て`add`されコミットされる。<br/>（管理対象外ファイルは、先に`add`を行っておく必要がある） |
| `-m, --message メッセージ` | メッセージを指定する。                                       |
| `--no-edit`                | メッセージの編集を省略する。                                 |

### revert

- コマンド

|コマンド|概要|
|---|---|
|`git revert コミット`|コミットを打ち消す。|

- オプション

|オプション|概要|
|---|---|
|`--mainline, -m <parent-number>`|マージコミットを打ち消すことができる。|

- `<parent-number>`は、`1`がマージされた側のブランチ、`2`がマージする側のブランチ。（なので基本的には`1`を指定する）
- [GitでMerge CommitをRevertする方法 - Qiita](https://qiita.com/awakia/items/5fad0c454ddc7b478ff1)

## 表示

### 共通

- コミットの記法

| 記法                                     | 概要             |
| ---------------------------------------- | ---------------- |
| `コミット~`, `コミット^`                 | 親1つ目          |
| `コミット~~`, `コミット~2`, `コミット^^` | 親1つ目の親1つ目 |
| `コミット^2`                             | 親2つ目          |
| `コミット^2^`                            | 親2つ目の親1つ目 |

- `コミット^`は、マージコミットを遡りたい場合などに使う。

- [【やっとわかった！】gitのHEAD^とHEAD~の違い - Qiita](https://qiita.com/chihiro/items/d551c14cb9764454e0b9)

- AuthorとCommiter

| 種類      | 概要                         |
| --------- | ---------------------------- |
| Author    | オリジナルのコードを書いた人 |
| Committer | コミットをした人             |

- ドット表記

  - [git diff と git log におけるドット表記](https://zenn.dev/yoichi/articles/git-dotted-notations)

### log, show

- コマンド

|コマンド|概要|
|---|---|
|`git log`|コミット履歴を表示する。|
|`git show [コミット]`|コミット詳細を表示する。|

- オプション（`log`）

| オプション                         | 概要                         | 例                                  |
| ---------------------------------- | ---------------------------- | ----------------------------------- |
| `--reverse`                        | ログを古い順に表示する。     |                                     |
| `--oneline`                        | ログを一行で表示する。       |                                     |
| `--pretty=format:項目フォーマット` | 項目フォーマットを指定する。 |                                     |
| `--date=format:日時フォーマット`   | 日時フォーマットを指定する。 | `--date=format:"%Y/%m/%d %H:%M:%S"` |

- 項目フォーマット
  [git logのフォーマットを指定する - Qiita](https://qiita.com/harukasan/items/9149542584385e8dea75)
  
  - `%h`：コミットID（短縮形）
  - `%x09`：タブ文字

### diff

- コマンド

| コマンド                                                     | 概要                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `git diff [--] [パス]`                                       | （指定したパスについて）インデックスからワークツリーへの差分を表示する。 |
| `git diff コミット [--] [パス]`                              | （指定したパスについて）指定したコミットからワークツリーへの差分を表示する。 |
| `git diff コミット1 コミット2 [--] [パス]`<br />`git diff [コミット1]..[コミット2] [--] [パス]` | （指定したパスについて）コミット1からコミット2への差分を表示する。 |
| `git diff [コミット1]...[コミット2] [--] [パス]`             | （指定したパスについて）2つのコミットの先祖から、コミット2への差分を表示する。<br />（`git diff $(git merge-base コミット1 コミット2) コミット2`と同義） |

- オプション

| オプション    | 概要                                                      |
| ------------- | --------------------------------------------------------- |
| `--name-only` | ファイル名のみ出力する。                                  |
| `--exit-code` | 差分があれば`1`、なければ`0`で終了ステータスを返す。      |
| `--quiet`     | `--exit-code`オプションを、標準出力をしない形で適用する。 |

### pathspec

- pathspec

| pathspec           | 概要             |
| ------------------ | ---------------- |
| `:!パス`, `:^パス` | パスを除外する。 |

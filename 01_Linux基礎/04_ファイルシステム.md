# ファイルシステム

## 共通

### 概要

- ファイルを保存するためには、パーティション上にファイルシステムを作る必要がある。

### 種類

| 名称                         | 概要                                                         | コマンド     |
| ---------------------------- | ------------------------------------------------------------ | ------------ |
| ext4（extended file system） | 多くのLinuxディストリビューションの標準ファイルシステム      | `mke2fs`     |
| Btrfs（B-tree file system）  | Linux向けの新しいファイルシステム                            | `mkfs.btrfs` |
| XFS（eXtents File System）   | CentOS 7などで標準となっている、ジャーナリングファイルシステム | `mkfs.xfs`   |

## mkfs

### コマンド

|コマンド|概要|
|---|---|
|`mkfs デバイス名`|パーティション上にファイルシステムを作成する。（各種ファイルシステムのフロントエンド）|

### オプション

|オプション|概要|
|---|---|
|`-t ファイルシステムタイプ`|ファイルシステムタイプを指定できる。|

## mkswap

### コマンド

| コマンド            | 概要                                       |
| ------------------- | ------------------------------------------ |
| `mkswap デバイス名` | パーティション上にスワップ領域を作成する。 |

## XFS

### コマンド

| コマンド  | 概要                                  |
| --------- | ------------------------------------- |
| `xfs_db`  | XFSファイルシステムのデバッグを行う。 |
| `xfs_fsr` | XFSファイルシステムのデフラグを行う。 |

## fsck, e2fsck

### コマンド

|コマンド|概要|
|---|---|
|`fsck デバイス名`|ディスクのチェックを行い、必要であれば修復を試みる。|
|`e2fsck デバイス名`|ディスクのチェックを行い、必要であれば修復を試みる。（ext2, ext3, ext4）|

### オプション

|オプション|概要|
|---|---|
|`-A`|`/etc/fstab`ファイルに記述されている全ファイルシステムをチェックする。|

## tune2fs

### コマンド

|コマンド|概要|
|---|---|
|`tune2fs デバイス名`|ext2, ext3, ext4の様々なパラメータを指定する。|

### オプション

| オプション | 概要                                                   |
| ---------- | ------------------------------------------------------ |
| `-c 回数`  | 何回マウント後にファイルシステムを検査するか指定する。 |
| `-i 間隔`  | ファイルシステムを検査する間隔を指定する。             |

## mount, umount

### コマンド

| コマンド                                  | 概要                                                         |
| ----------------------------------------- | ------------------------------------------------------------ |
| `mount`                                   | マウント状況を表示する。                                     |
| `mount [デバイス名] [マウントポイント]`   | ファイルシステムをマウントする。<br />引数のどちらかを省略すると、`/etc/fstab`ファイルの記述が参照される。 |
| `umount デバイス名またはマウントポイント` | ファイルシステムをアンマウントする。                         |

### オプション（`mount`）

| オプション                  | 概要                                                 |
| --------------------------- | ---------------------------------------------------- |
| `-a, --all`                 | `/etc/fstab`ファイルの全てのデバイスをマウントする。 |
| `-t ファイルシステムタイプ` | ファイルシステムタイプを指定する。                   |

## /etc/fstab

### ファイル

| ファイル     | 概要                                           |
| ------------ | ---------------------------------------------- |
| `/etc/fstab` | マウントするファイルシステムの情報を記述する。 |

### 記法

```text
デバイス名   マウントポイント   ファイルシステムの種類   マウントオプション   dumpフラグ   fsckフラグ
```

### 例

```text
/dev/sda1        /home           ext4    defaults        1 1
```

## /etc/mtab

### ファイル

| ファイル    | 概要                                               |
| ----------- | -------------------------------------------------- |
| `/etc/mtab` | マウントされたファイルシステムの情報が格納される。 |

# Linux/サービス管理/systemd

## 共通

### 概要

- systemdを採用したシステムでは、initプロセスの代わりに、systemdプロセスが起動する。

### Unit

- systemdでは、システムの起動処理は、多数の**Unit**と呼ばれる処理単位に分かれている。

| 拡張子     | 概要                                     |
| ---------- | ---------------------------------------- |
| `.service` | サービスを管理するUnit                   |
| `.device`  | 各種デバイスを管理するUnit               |
| `.mount`   | ファイルシステムのマウントを管理するUnit |
| `.swap`    | スワップ領域を管理するUnit               |
| `.target`  | 複数のサービスを一つにするUnit           |

### ファイル

- ファイル

| ファイル                              | 概要                                       |
| ------------------------------------- | ------------------------------------------ |
| `/etc/systemd/system/default.target`  | 最初に実行されるUnit                       |
| `/lib/systemd/system`ディレクトリ配下 | オリジナルのスクリプトファイル。           |
| `/etc/systemd/system`ディレクトリ配下 | ホストごとに修正されたスクリプトファイル。 |

### systemctl

- コマンド

|コマンド|概要|
|---|---|
|`systemctl サブコマンド [Unit名]`|systemdでサービスを管理できる。<br />Unit名の`.service`は省略できる。|

- サブコマンド

| サブコマンド             | 概要                             |
| ------------------------ | -------------------------------- |
| `start`                  | サービスを起動する。             |
| `stop`                   | サービスを終了する。             |
| `restart`                | サービスを再起動する。           |
| `enable`                 | サービスの自動起動を有効にする。 |
| `disable`                | サービスの自動起動を無効にする。 |
| `get-default`            | デフォルトのモードを表示する。   |
| `set-default ターゲット` | デフォルトのモードを変更する。   |
| `poweroff`               | システムをシャットダウンする。   |
| `reboot`                 | システムを再起動する。           |

### service

- コマンド

|コマンド|概要|
|---|---|
|`service Unit名 サブコマンド`|単にシェルを実行する形で、サービスの起動や停止、状態確認などを行う。|

- `service`より`systemctl`コマンドを使うことが望ましい。
  [Linuxのコマンド実行で使うserviceとsystemctlの違いとは何か？ | CodeLog](https://www.toumasu-program.net/qfr8l41pigu2v05ztwbc)

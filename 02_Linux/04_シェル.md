# シェル

## 使用するシェル

### 概要

- `/etc/shells`で、使用可能なシェル一覧を確認できる。
- 環境変数`SHELL`で、デフォルトのシェルを確認できることもあるが、あまり信頼できない。
- `/etc/passwd`でも、デフォルトのシェルを確認できる。

### chsh

- `chsh`コマンドで、デフォルトのシェルを変更できる。

  ```bash
  chsh [ユーザー（省略時はカレントユーザー）]
  ```

## Bash設定

### プロンプト

- 環境変数`PS1`で、プロンプトを設定できる。（デフォルトは`\h:\W \u\$`）
- 環境変数`PS2`で、セカンダリプロンプト（2行目以降のプロンプト）を設定できる。

### bash_profile, bashrc

- [【初心者向け】エイリアスの設定方法 - Qiita](https://qiita.com/yutat93/items/b5bb9c0366f21bcbea62)
- [本当に正しい .bashrc と .bash_profile の使ひ分け - Qiita](https://qiita.com/magicant/items/d3bb7ea1192e63fba850)
- `bash_profile`と`bashrc`

  ファイル|読み込みタイミング|用途
    ---|---|---
  ~/.bash_profile|ログイン時|環境変数の設定
  ~/.bashrc|ログイン以外の対話的シェル起動時|エイリアスの設定、bashオプションの設定

- `bash_profile`から`bash_rc`を読み込むよう記述することもある。

  ```bash
  if [ -f ~/.bashrc ]; then
    . ~/.bashrc
  fi
  ```

### PROMPT_COMMAND

- 環境変数`PROMPT_COMMAND`には、プロンプトを出す前に実行するコマンドを指定する。

## シェルオプション

### set -o

- `set -o`コマンドは、シェルの設定を変更できる。
  - 書式1

    ```bash
    set -o シェルオプション
    ```

  - 書式2

    ```bash
    set -シェルオプション一文字
    ```

- `-`はシェルの設定を有効にし、`+`は無効にする。

### シェルオプション一覧

- `-e, errexit`で、コマンドが1つでもエラーになったら、直ちにシェルを終了する。
- `-u, nounset`で、パラメーター展開中に、設定していない変数があったらエラーとする。
- `-c, noclobber`で、リダイレクトで既存のファイルを上書きしない。
- `-x, xtrace`で、実際に実行されたコマンドを表示する。
- `-v, verbose`で、書いたままのコマンドを表示する。

## tmux

### 概要

- `tmux`コマンドは、一つの端末画面の中に、複数のウィンドウを作成する。

  ```bash
  tmux [サブコマンド]
  ```

- ウィンドウの動作状態を保ったままセッションを終了させるのを**デタッチ**、それに再接続することを**アタッチ**と呼ぶ。
- Macでは、インストールが必要。

### ls

- `ls`サブコマンドで、デタッチしたセッションの一覧を表示する。

### attach

- `attach`サブコマンドで、デタッチしたセッションにアタッチする。
- `-t セッション番号`で、セッションを指定してデタッチする。（省略時は最新のセッション）

### new-session

- `new-session`サブコマンドで、新しいセッションを開始する。（`tmux`コマンドと同じ）

### kill-session

- `kill-session`サブコマンドで、最新のセッションを削除する。
- `-t セッション番号` で、削除するセッションを指定できる。

### kill-server

- `kill-server`サブコマンドで、全てのセッションを削除する。

### tmux内操作

- 「Ctrl + B」をプリフィックスキーと呼ぶ。
- ウィンドウ操作
  - 「プリフィックスキー + C」で、新しいウィンドウを作成する。
  - 「プリフィックスキー + ウィンドウの番号」で、任意の番号のウィンドウに切り替える。
  - 「プリフィックスキー + N/P」で、前後のウィンドウに切り替える。
  - 「プリフィックスキー + &」で、ウィンドウを削除する。
- セッション操作
  - 「プリフィックスキー + D」で、デタッチする。

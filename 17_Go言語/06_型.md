# 型

## 共通

### 分類

- 分類

| 型     | 例                                                           | 初期値      |
| ------ | ------------------------------------------------------------ | ----------- |
| 値型   | 基本型、配列型、構造体                                       | `0`や空文字 |
| 参照型 | スライス、マップ、チャネル、ポインタ、インターフェース、関数 | `nil`       |

### キャスト

- Go言語では、暗黙的なキャストは行われない。
- 明示的にキャストする場合は、`型名(値)`とする。
- 数値・文字列の変換などには、`strconv`パッケージを使う。

### 型アサーション

- 型アサーションで、`interface{}`型変数の型をチェック・変換できる。

  ```go
  型変換後の値, 型変換が成功したか := 変数.(型)
  ```

- 例

  ```go
  hoge, ok := fuga.(int)
  ```

### type

- `type`は、型にエイリアスを設定する。

  ```go
  type 新しい型 型
  ```

- エイリアスは派生元と型の互換性があるが、エイリアス同士は互換性がない。

## 基本型

### 数値型

- 型

| 型                                 | 概要                                                 | リテラル   |
| ---------------------------------- | ---------------------------------------------------- | ---------- |
| `intビット数`                      | そのビット数の整数                                   |            |
| `uintビット数`                     | そのビット数の非負整数                               |            |
| `int`                              | 実装ビット数に応じた整数                             | `1`        |
| `uint`                             | 実装ビット数に応じた非負整数                         |            |
| `uintptr`                          | ポインタの値をそのまま格納するのに十分な大きさの整数 |            |
| `float32`, `float64`（デフォルト） | 浮動小数点                                           | `1.5`      |
| `complex64`, `complex128`          | 複素数                                               | `1.5 + 3i` |

- Go言語では、桁数のオーバーフローが生じた際に、ラップアラウンドが起こる（数値が循環する）。

- `real(複素数)`関数で実部が、`imag(複素数)`関数で虚部が取り出せる。

### 文字列型

- 型

| 型       | 概要                    | リテラル |
| -------- | ----------------------- | -------- |
| `rune`   | 文字（`int32`型の別名） | `'a'`    |
| `string` | 文字列                  | `"abc"`  |

- バッククォーテーションで複数行の文字列を記述できる。（RAW文字列リテラル）
- 一度生成された文字列は不変である。（その都度新しい文字列が生成される）

## チャネル

### 概要

- チャネルは、ゴルーチン間でデータを受け渡すための型である。

- 型

| 型          | 概要                       |
| ----------- | -------------------------- |
| `chan 型`   | 受信・送信が可能なチャネル |
| `<-chan 型` | 受信専用のチャネル         |
| `chan<- 型` | 送信専用のチャネル         |

### バッファ

- チャネルは、キューの性質を持つバッファを持ち、そのサイズは指定できる。
- 以下の場合はランタイムパニックが発生する。
  - バッファが空のチャネルから受信する。
  - バッファに空きがないチャネルに送信する。

### len, cap

- `len`関数は、チャネルのバッファ内に溜められているデータの個数を取得する。
- `cap`関数は、チャネルのバッファサイズを取得する。

### close

- `close`関数は、チャネルをクローズする。
- クローズされたチャネルに送信すると、ランタイムパニックとなる。（受信は可能）
- 受信時の第2引数に、「チャネルのバッファ内が空でないか、またはクローズされていないか」の真偽値を取ることができる。

### select

- `select`文は、caseのうち実行できる処理をランダムで実行する。

  ```go
  select {
  case チャネルへの処理1:
    処理1
  case チャネルへの処理2:
    処理2
  ...
  default:
    処理
  }
  ```

## ポインタ

### 概要

- ポインタ型は`*型`で表し、初期値は`nil`となる。

### アドレス演算子・デリファレンス

- `&変数`で、任意の型からそのポインタ型を生成する。
- `*変数`で、ポインタ型が指し示すデータのデリファレンスができる。
- 配列やスライスは、デリファレンスを省略できる。

### new

- `new`は、指定した型のポインタ型を生成する。

  ```go
  new(型)
  ```

## 構造体

### 概要

- 構造体は値型の一種で、各フィールドは型に合わせた初期値を取る。
- 構造体を参照渡ししたい場合は、ポインタ型にして使う。

### struct

- `struct`は、構造体を定義する。（基本的に`type`と組み合わせて使う）

  ```go
  type 構造体名 struct {
    [フィールド名1] 型1
    [フィールド名2] 型2
    ...
  }
  ```

- フィールド名省略時は、型名（プリフィックスを除く）となる。
- フィールド名を`_`とすると、無名フィールド（参照も代入もできないフィールド）となる。

### タグ

- 構造体には、「タグ」というフィールドのメタ情報を追加できる。

  ```go
  struct {
    [フィールド名1] 型1 "タグ1"
    [フィールド名2] 型2 "タグ2"
    ...
  }
  ```

### 生成（フィールド名未指定）

- 書式

  ```go
  構造体名{値1, 値2, ...}
  ```

- フィールドの数が合っていなければ、コンパイルエラーとなる。

### 生成（フィールド名指定）

- 書式

  ```go
  構造体名{フィールド名1: 値1, フィールド名2: 値2, ...}
  ```

- フィールドは一部だけ指定することができる。
- この書式が推奨である。

### コンストラクタ

- コンストラクタは存在しないが、`New型名`という関数で実装することが多い。

### 参照

- フィールド名省略時は、一意に定まる場合に限り、中間フィールドを省略してアクセスできる。

## インターフェース

### 概要

- インターフェースは、あるメソッドを持つ型を表す。

### 定義

- 書式

  ```go
  interface {
    メソッド名1(引数1) 戻り値の型1
    メソッド名2(引数2) 戻り値の型2
    ...
  }
  ```

- インターフェースの中にインターフェースを含むこともできる。

### interface{}型

- `interface{}`型は、実装すべきメソッドが一つもないインターフェース＝**全ての型と互換性を持つ型**である。

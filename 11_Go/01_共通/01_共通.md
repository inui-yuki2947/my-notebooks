# Go/共通/共通

## 共通

### Go言語の特徴

- ネイティブコードにコンパイルされる。
- マルチプラットフォームで動作する。（OSの標準ライブラリにすら依存しない）
- オブジェクト指向を有さず、関数と構造体で記述する。
- 使用されていない`import`文や変数があると、厳密にコンパイルエラーを出す。

### ドキュメント

- [go.dev](https://go.dev/)
- [A Tour of Go](https://go-tour-jp.appspot.com/list)
- [他言語プログラマがgolangの基本を押さえる為のまとめ - Qiita](https://qiita.com/tfrcm/items/e2a3d7ce7ab8868e37f7)

## ビルド・実行

### 共通

- コマンド

| コマンド                        | 概要                                                         |
| ------------------------------- | ------------------------------------------------------------ |
| `go build`                      | カレントディレクトリの全てのGoファイル（`*.go`）を、ビルドコンパイルする。 |
| `go build パッケージファイル名` | 指定したGoファイルを、ビルドコンパイルする。                 |
| `go run パッケージファイル名`   | Goファイルをビルドコンパイル・実行する。<br />同パッケージのファイルを使用する場合は、それも引数に指定する。 |

### build

- オプション

|オプション|概要|
  |---|---|
|`-o 出力ファイル名`|出力ファイル名を指定できる。（未指定時は、カレントディレクトリ名となる）|

## テスト

### test

- コマンド

|コマンド|概要|
  |---|---|
|`go test [パッケージファイル名]`|テストファイル（名前が`_test.go`で終わるファイル）を実行する。|

- オプション

|オプション|概要|
  |---|---|
|`-cover`|カバレッジ率が表示される。|

### テストコード

- 書式

  ```go
  func TestXXX(t *testing.T) {
    処理
  }
  ```

## モジュール

### GOPATHモードとモジュール対応モード

- 種類
  
| 種類                 | バージョン         | 概要                                                         |
| -------------------- | ------------------ | ------------------------------------------------------------ |
| GOPATHモード         | バージョン1.10まで | 標準ライブラリを除く全てのパッケージのコード管理とビルドを、<br />環境変数 GOPATH で指定されたディレクトリ下で行う。 |
| モジュール対応モード | バージョン1.11から | 標準ライブラリを除く全てのパッケージをモジュールとして管理する。 |
  
- 環境変数`GO111MODULE`で、2つのモードの切り替えができる。
  
- IntelliJでは、プロジェクト作成時の設定、またはPreferenceの「Go modules integration」で、2つのモードの切り替えができる。

- [Go のモジュール管理【バージョン 1.17 改訂版】](https://zenn.dev/spiegel/articles/20210223-go-module-aware-mode)

- [【Go】パッケージ/モジュールやgo modコマンドについてまとめ - フラミナル](https://blog.framinal.life/entry/2021/04/11/013819)

### モジュール

- モジュールとは、`go.mod`ファイルのあるディレクトリごとの集まり。
- バージョン管理のリビジョンと連動しているため，基本的には「1リポジトリ＝1モジュール」である。
- モジュール名は、`github.com/ユーザー名/リポジトリ名`とすることが多い。
- 使用するファイル
  - `go.mod`ファイルには、依存モジュールが記録される。
  - `go.sum`ファイルには、依存モジュールのチェックサムが記録される。

### mod init

- コマンド

|コマンド|概要|
  |---|---|
|`go mod init [モジュール名]`|モジュールの初期化を行う。（`go.mod`ファイルを作成する）|

### mod tidy

- コマンド

|コマンド|概要|
  |---|---|
|`go mod tidy`|ソースコードの`import`文を必要十分に満たすように、パッケージをインストールし、`go.mod`と`go.sum`を修正する。|

### install

- コマンド

|コマンド|概要|
  |---|---|
|`go install [パッケージ名]`|パッケージをインストールする。|

- パッケージ名のサフィックスにバージョン（`@latest`や`@1.0.0`）を与えると、`go.mod`ファイルを無視してインストールを行う。

### get

- コマンド

|コマンド|概要|
  |---|---|
|`go get [パッケージ名]`|パッケージをインストールし、`go.mod`、`go.sum`ファイルに追記する。|

- オプション

|オプション|概要|
  |---|---|
|`-u`|新しいマイナー・パッチリリースを取得する。|

### ベンダリング

- Goのバージョン1.6から、ベンダリング（依存するパッケージの固定化機構）がデフォルトで有効化された。
- パッケージを`vendor`ディレクトリに置くと、それが環境変数`GOPATH`より優先的に読み込まれるようになる。

## その他

### help

- コマンド

|コマンド|概要|
  |---|---|
|`go help [サブコマンド]`|コマンドのマニュアルを表示する。|

### doc

- コマンド

| コマンド                                                     | 概要                                   |
| ------------------------------------------------------------ | -------------------------------------- |
| `go doc [パッケージ]`<br />`go doc [[パッケージ.]シンボル[.メソッド]]` | Goパッケージのドキュメントを表示する。 |

- ドキュメント内容としては、コード内のコメントが利用される。

### fmt

- コマンド

|コマンド|概要|
  |---|---|
|`go fmt [パッケージファイル名]`|Goファイルのコードをフォーマットする。|

- 内部的には、`gofmt`コマンドを実行している。

### env

- コマンド

|コマンド|概要|
  |---|---|
|`go env`|Goの環境変数一覧を表示する。|

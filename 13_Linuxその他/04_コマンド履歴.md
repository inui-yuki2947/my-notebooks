# コマンド履歴

## 共通

### コマンド履歴のフロー

1. Bash起動時に、`~/.bash_history`から読み込まれる。
1. Bash使用中は、キャッシュが使用される。
1. Bash終了時に、`~/.bash_history`に書き込まれる。

### 環境変数

| 環境変数         | 概要                                              | デフォルト値      |
| ---------------- | ------------------------------------------------- | ----------------- |
| `HISTFILE`       | コマンド履歴を記録するファイル。                  | `~/.bash_history` |
| `HISTSIZE`       | シェルのコマンド履歴での保存数。                  |                   |
| `HISTFILESIZE`   | コマンド履歴ファイルでの保存数。                  |                   |
| `HISTCONTROL`    | コマンドの保存方法。（`:`で区切って複数指定可能） |                   |
| `HISTTIMEFORMAT` | コマンド履歴の日時フォーマット。                  |                   |

### `HISTCONTROL`の値

| `HISTCONTROL`の値 | 概要                                                   |
| ----------------- | ------------------------------------------------------ |
| `ignorespace`     | 空白で始まるコマンドを保存しない。                     |
| `ignoredups`      | 直前の履歴と一致するコマンドを保存しない。             |
| `ignoreboth`      | `ignoredups` + `ignorespace`                           |
| `erasedups`       | 現在のコマンドと一致する履歴を保存前にすべて削除する。 |

### ドキュメント

- [history コマンドに日時を付与する - Qiita](https://qiita.com/bezeklik/items/56a597acc2eb568860d7)

## history

### コマンド

|コマンド|概要|
|---|---|
|`history`|コマンド履歴を**全て**表示する。|
|`history 件数`|コマンド履歴を**件数分**表示する。|

### オプション

| オプション            | 概要                                                         |
| --------------------- | ------------------------------------------------------------ |
| `-r [ファイル名]`     | 履歴ファイルからキャッシュに、**全て追記**する。             |
| `-n [ファイル名]`     | 履歴ファイルからキャッシュに、**読み込んでいないものを追記**する。 |
| `-w [ファイル名]`     | キャッシュから履歴ファイルに、**上書き**する。               |
| `-a [ファイル名]`     | キャッシュから履歴ファイルに、**書き込んでいないものを追記**する。 |
| `-d コマンド履歴番号` | 指定したコマンド履歴を削除する。（`history -w`すると、ファイルに反映される） |
| `-c`                  | 全コマンド履歴を削除する。（シェル終了時に、ファイルに反映される） |

### その他

- 編集したコマンド履歴には、`*`マークがつく。

## fc

### コマンド（実行系）

| コマンド                       | 概要                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| `fc [対象]`                    | 対象（省略時は直前）のコマンド履歴を編集し、実行する。       |
| `fc 対象開始 対象終了`         | 対象開始から対象終了までのコマンド履歴を編集し、**全て**実行する。 |
| `fc -s [置換前=置換後] [対象]` | 対象（省略時は直前）のコマンド履歴を置換し、実行する。       |

### コマンド（表示系）

| コマンド                    | 概要                                               |
| --------------------------- | -------------------------------------------------- |
| `fc -l`                     | 直近16件のコマンド履歴を表示する。                 |
| `fc -l 対象開始 [対象終了]` | 対象開始から対象終了までのコマンド履歴を表示する。 |
| `fc -l -件数`               | 件数分のコマンド履歴を表示する。                   |

### 対象

| 対象     | 概要                               |
| -------- | ---------------------------------- |
| `文字列` | 文字列から始まる直近のコマンド履歴 |
| `番号`   | 該当番号のコマンド履歴             |

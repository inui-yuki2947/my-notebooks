# ネットワーク設定

## 共通

### コマンド

- net-toolsのコマンドは非推奨であり、iproute2のコマンドを使用するのがよい。

| net-tools  | iproute2 |
| ---------- | -------- |
| `ifconfig` | `ip a`   |
| `route`    | `ip r`   |
| `netstat`  | `ss`     |

- [net-toolsとiproute2のコマンド対応早見表 | 俺的備忘録 〜なんかいろいろ〜](https://orebibou.com/ja/home/201412/20141215_002/)

- [ifconfigコマンドとipコマンドの違いと比較 – エラーの向こうへ](https://tech.mktime.com/entry/211)

## ネットワークインターフェース

### 概要

- ネットワークインターフェースは、1番目のものから`eth0`, `eth1`となる。（環境によって名前が異なることもある）
- `lo`は、「ローカルループバック」のことである。

- 設定ファイル

| ファイル                         | 概要                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| `/etc/network/interfaces`        | Debian系ディストリビューションで、ネットワークインターフェースの設定を記述する。 |
| `/etc/sysconfig/network-scripts` | Red Hat系ディストリビューションで、ネットワークインターフェースの設定を記述する。 |

### ip

- コマンド

|コマンド|概要|
|---|---|
|`ip オブジェクト [サブコマンド]`|ネットワークの各情報を管理する。|

- オブジェクト

| オブジェクト       | 概要                                 |
| ------------------ | ------------------------------------ |
| `l, link`          | ネットワークデバイス                 |
| `a, addr, address` | ネットワークデバイスとそのIPアドレス |
| `r, route`         | ルーティングテーブル                 |

- サブコマンド

| サブコマンド | 概要                             |
| ------------ | -------------------------------- |
| `show`       | 表示する。（省略時のデフォルト） |
| `add`        | 追加する。                       |
| `del`        | 削除する。                       |

### nmcli

- コマンド

|コマンド|概要|
|---|---|
|`nmcli オブジェクト [サブコマンド]`|Red Hat系ディストリビューションで、NetworkManagerの管理を行う。|

- オブジェクト・サブコマンド

| オブジェクト    | サブコマンド        | 概要                                          |
| --------------- | ------------------- | --------------------------------------------- |
| `g, general`    | `status`            | NetworkManagerの状態を表示する。              |
| `n, networking` | `connectivity`      | ネットワークの接続状態を表示する。            |
| `r, radio`      | `wifi`              | Wi-Fiの状態を表示する。                       |
| `r, radio`      | `wifi on, off`      | Wi-Fi接続を有効化・無効化する。               |
| `c, connection` | `show`              | 接続状況を表示する。                          |
| `d, device`     | `status`            | デバイスの状態を表示する。                    |
| `d, device`     | `wifi connect SSID` | Wi-Fiに接続するデバイスを作成し、有効化する。 |

### ifconfig

- コマンド

| コマンド                           | 概要                                           |
| ---------------------------------- | ---------------------------------------------- |
| `ifconfig [インターフェース名]`    | ネットワークインターフェースの情報を表示する。 |
| `ifconfig インターフェース名 操作` | ネットワークインターフェースの操作を行う。     |

- 操作

| 操作                       | 概要                         |
| -------------------------- | ---------------------------- |
| `up`                       | インタフェースを有効にする。 |
| `down`                     | インタフェースを無効にする。 |
| `IPアドレス`               | IPアドレスを設定する。       |
| `netmask サブネットマスク` | サブネットマスクを設定する。 |

### ifup, ifdown

- コマンド

|コマンド|概要|
|:--|---|
|`ifup [インターフェース名]`|ネットワークインターフェースを有効にする。|
|`ifdown [インターフェース名]`|ネットワークインターフェースを無効にする。|

### route

- コマンド

| コマンド                                                     | 概要                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `route`                                                      | ルーティングテーブルを表示する。（`ip route`コマンドと同じ） |
| `route add [-host, -net] 宛先IPアドレス [gw ゲートウェイのIPアドレス] [reject] [[dev] インタフェース]` | ルーティングテーブルに経路を追加する。                       |
| `route del [-host, -net] 宛先IPアドレス [gw ゲートウェイのIPアドレス] [[dev] インタフェース]` | ルーティングテーブルの経路を削除する。                       |

- オプション

| オプション | 概要                                       |
| ---------- | ------------------------------------------ |
| `-4`       | IPv4の情報を表示・操作する。（デフォルト） |
| `-6`       | IPv6の情報を表示・操作する。               |

- [route　～ルーティングテーブルの表示／設定を行う：ネットワークコマンド使い方 - ＠IT](https://atmarkit.itmedia.co.jp/ait/articles/0111/01/news002.html)

## ネットワークの状態

### 共通

- コマンド

|コマンド|概要|
|---|---|
|`netstat`|ネットワークの各種状態を表示する。|
|`ss [フィルター]`|ネットワークの各種状態を表示する。|

### netstat

- オプション

| オプション | 概要                             |
| ---------- | -------------------------------- |
| `-a`       | 全てのソケット情報を表示する。   |
| `-r`       | ルーティングテーブルを表示する。 |
| `-t`       | TCPポートのみ表示する。          |
| `-u`       | UDPポートのみ表示する。          |

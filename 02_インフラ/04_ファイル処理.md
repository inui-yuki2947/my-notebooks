# ファイル処理

## 表示

### ls

- `ls`コマンドは、ファイルの一覧を表示する。

  ```bash
  ls [ファイルまたはディレクトリ...]
  ```

- `-a`オプションで、隠しファイルを表示する。
- `-A`オプションで、隠しファイルを表示する。（`.`及び`..`を除く）
- `-d`オプションで、ディレクトリ自体の情報を表示する。
- `-l`オプションで、ファイルの詳細を表示する。

### tree

- `tree`コマンドは、ファイルやディレクトリをツリー状に表示する。

  ```bash
  tree [ディレクトリ]
  ```

- Macではインストールが必要。

### find

- `find`コマンドは、ファイル・ディレクトリを検索する。

  ```bash
  find パス [検索式]
  ```

- 検索式
  - `-name パターン`で、ファイル名による検索ができる。
  - `-atime, -ctime, -mtime`で、最終アクセス日時・あらゆる変更日時・ファイル内容の変更日時で検索できる。
  - `-and, -or`で、条件を複数指定できる。また丸括弧で評価順を変更できる。
  - `-print0`で、**区切り文字**をヌル文字に変更できる（結果をxargsに渡すときなどに使う）。
- `-maxdepth 深さ`オプションで、検索するディレクトリの深さを指定できる。

### file

- `file`コマンドは、ファイルの形式を表示する。

  ```bash
  file ファイル名
  ```

### basename, dirname

- `basename`コマンドは、パスからファイル名部分を取得する。

  ```bash
  basename パス
  ```

- `dirname`コマンドは、パスからディレクトリ名部分（末尾スラッシュを除く）を取得する。

  ```bash
  dirname パス
  ```

## 作成・削除

### touch

- `touch`コマンドは、ファイルのタイムスタンプを変更する。

  ```bash
  touch ファイル...
  ```

- `-t 日時`オプションで、タイムスタンプを指定できる。
  - 形式：`[[CC]YY]MMDDhhmm[.ss]`

### rm

- `rm`コマンドは、ファイルを削除する。（通常はディレクトリを削除できない）

  ```bash
  rm ファイル...
  ```

- `-r, -R, --recursive`オプションで、ディレクトリを再帰的に削除する。

### mkdir, rmdir

- `mkdir`コマンドは、空のディレクトリを作成する。

  ```bash
  mkdir ディレクトリ名
  ```

- `rmdir`コマンドは、**空の**ディレクトリを削除する。

  ```bash
  rmdir ディレクトリ名
  ```

- `-p`オプション
  - 必要に応じて親ディレクトリも作成・削除できる。
  - ディレクトリが既に存在する場合でも、エラーを吐かなくなる。

### mktemp

- `mktemp`コマンドは、適当な名前の空ファイルを作成する。

  ```bash
  mktemp テンプレート文字列
  ```

- `-d`オプションで、ファイルではなくディレクトリを作成する。

## 移動・コピー

### mv

- `mv`コマンドは、ファイルを移動またはリネームする。

  ```bash
  mv 移動元 移動先
  ```

### rename

- `rename`コマンドは、ファイルを（まとめて）リネームする。

  ```bash
  rename s/置換前/置換後/ [ファイル名...]
  ```

- Macではインストールが必要。
- パスに含まれるディレクトリ名も、置換対象に含まれる。

### cp

- `cp`コマンドは、ファイルをコピーする。

  ```bash
  cp [コピー元...] コピー先
  ```

- `-r`オプションで、ディレクトリをコピーできる。
- `-p`オプションで、ファイルのパーミッション・所有者・タイムスタンプを保ったままコピーする。

### scp

- `scp`コマンドは、リモートでファイルをコピーする。

  ```bash
  scp コピー元 コピー先
  ```

- リモートのファイルをローカルにコピーする場合

  ```bash
  scp user@xxx.xxx.xxx.xxx:~/test.txt ./
  ```

### rsync

- `rsync`コマンドは、賢い`scp`コマンド。
- `--update`オプションで、更新日時が新しいものを優先した上でコピーが行われる。
- `--times`オプションで、更新日時をコピー元と同じにすることができる。
- `--delete`オプションで、コピー先にしかないファイルを削除できる。

## リンク

### ハードリンクとソフトリンク

- ハードリンク
  - inodeへのリンク
  - 各パスが変わっても影響はない。
  - 同じinodeを示すリンクが無くならない限り、ファイル実体は削除されない。
  - ディレクトリや別のファイルシステムへのリンクは作成できない。
- ソフトリンク（シンボリックリンク）
  - ファイルパスへのリンク
  - 元のパスが変わるとアクセスできなくなる。
  - ディレクトリや別のファイルシステムへのリンクも作成できる。

### ln

- `ln`コマンドは、リンクを作成する。

  ```bash
  ln リンク先 リンク名
  ```

- デフォルトではハードリンクを作成するが、`-s`オプションでシンボリックリンクを作成する。

### その他

- `ls`コマンドで、ハードリンクが作成されている数を確認できる。
- `ls -i`コマンドで、iノード番号を確認できる。
- `cp`コマンドは、シンボリックリンクのリンク先をコピーするが、
  `-d`オプションで、シンボリックリンク自体をコピーできる。

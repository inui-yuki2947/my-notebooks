# MySQL/ストアドプログラム/トリガー

## 共通

### 概要

- [MySQL :: MySQL 5.6 リファレンスマニュアル :: 20.3 トリガーの使用](https://dev.mysql.com/doc/refman/5.6/ja/triggers.html)

## CREATE TRIGGER

### 記法

```mysql
CREATE TRIGGER トリガー名
    <BEFORE|AFTER> <INSERT|UPDATE|DELETE>
    ON テーブル名
    FOR EACH ROW
    ステートメント
```

### 変数

| 変数           | 概要                                 | INSERT | UPDATE | DELETE | I/O  |
| -------------- | ------------------------------------ | ------ | ------ | ------ | ---- |
| `OLD.カラム名` | 古いレコードの、指定したカラムの値。 | ☓      | ○      | ○      | O    |
| `NEW.カラム名` | 新しいレコードの、指定したカラム値。 | ○      | ○      | ☓      | I/O  |

### トリガー名

- トリガー名は、**スキーマ内**で一意である必要がある。
- トリガー名は、スネークケースが一般的？

### その他

- トリガーイベント・時間が同じトリガーは、複数定義できない。
- `BEFORE`トリガーが失敗した場合、その後の操作は実行されない。
- `BEFORE INSERT`では、`AUTO_INCREMENT`カラムの値は`0`となっている。
- [トリガーの開発方法＆デバッグ方法 - Qiita](https://qiita.com/suin/items/269fa582e40f439d012f)

## DROP TRIGGER

### 記法

```mysql
DROP TRIGGER [IF EXISTS] [スキーマ名.]トリガー名
```

## SHOW TRIGGERS

### 記法

| 記法                                        | 概要                       |
| ------------------------------------------- | -------------------------- |
| `SHOW TRIGGERS [<FROM｜IN> データベース名]` | トリガーの一覧を表示する。 |

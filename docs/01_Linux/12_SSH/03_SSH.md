# Linux/SSH/SSH

## ssh

### コマンド

| コマンド                                   | 概要                                                         |
| ------------------------------------------ | ------------------------------------------------------------ |
| `ssh [ユーザー名@]ホスト名 [コマンド]`     | SSH接続し、コマンドを実行する。<br />ユーザー名省略時は、ローカルと同名のユーザー名でログインする。 |
| `ssh 接続名 [コマンド]`                    | 設定ファイルに記述した接続情報で接続し、コマンドを実行する。 |
| `autossh [ユーザー名@]ホスト名 [コマンド]` | 自動で再接続を行うように`ssh`を実行する。                    |

### オプション

| オプション          | 概要                               |
| ------------------- | ---------------------------------- |
| `-i 秘密鍵ファイル` | 使用する秘密鍵ファイルを指定する。 |
| `-p ポート番号`     | ポート番号を指定する。             |

### オプション（ポートフォワード系）

| オプション                                              | 概要                                                         |
| ------------------------------------------------------- | ------------------------------------------------------------ |
| `-L ローカルのポート:リモートのホスト:リモートのポート` | ローカルフォワードを行う。（入り口がローカル、出口がリモート） |
| `-R リモートのポート:ローカルのホスト:ローカルのポート` | リモートフォワードを行う。（入り口がリモート、出口がローカル） |
| `-g`                                                    | ローカル以外でもポートフォワードを行う。                     |
| `-N`                                                    | シェルを開かないようにする。                                 |
| `-f`                                                    | プロセスをバックグラウンドで実行する。                       |
| `-A`                                                    | エージェント転送を行う。<br/>（1つ目のサーバに接続後、続けて別のサーバに接続する際に、最初に使った秘密鍵をそのまま使用する） |

- 入り口・出口のホスト・ポートは、入り口・出口から見たホスト・ポートを指定する。
  （例：出口のホストが`localhost`の場合、それは出口のローカルホストである）

### ホスト認証

- SSHでは、ユーザー名とパスワードによる**ユーザー認証**に先立って、クライアントがサーバの正当性を確認する**ホスト認証**が行われる。
- 初回接続時に、ホストを信頼するかどうかを聞かれる。
- 信頼したホストは、`~/.ssh/known_hosts`ファイルに登録される。

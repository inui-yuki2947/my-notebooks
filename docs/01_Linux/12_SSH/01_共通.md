# Linux/SSH/共通

## 共通

### 概要

- SSHは、Telnetよりもセキュアにリモートホスト間通信を行うプロトコルである。
- SSHの実装である**OpenSSH**が一般的に利用されている。
- sshクライアントには、TeraTermやPuTTYなどがある。

## ssh, autossh

### コマンド

| コマンド              | 概要                                    |
| --------------------- | --------------------------------------- |
| `ssh 接続名`          | SSH接続する。                           |
| `ssh 接続名 コマンド` | SSH接続し、コマンドを実行する。         |
| `autossh 接続名`      | 自動で再接続を行うように、SSH接続する。 |

### 接続名

| 接続名                | 概要                                                     |
| --------------------- | -------------------------------------------------------- |
| `ホスト名`            | ローカルと同名のユーザー名、指定したホスト名で接続する。 |
| `ユーザー名@ホスト名` | 指定したユーザー名・ホスト名で接続する。                 |
| `任意の名前`          | 設定ファイルに記述された情報で接続する。                 |

### オプション

| オプション          | 概要                               |
| ------------------- | ---------------------------------- |
| `-i 秘密鍵ファイル` | 使用する秘密鍵ファイルを指定する。 |
| `-p ポート番号`     | ポート番号を指定する。             |

### オプション（ポートフォワード系）

| オプション                                              | 概要                                                         |
| ------------------------------------------------------- | ------------------------------------------------------------ |
| `-L ローカルのポート:リモートのホスト:リモートのポート` | ローカルフォワードを行う。（入り口がローカル、出口がリモート） |
| `-R リモートのポート:ローカルのホスト:ローカルのポート` | リモートフォワードを行う。（入り口がリモート、出口がローカル） |
| `-g`                                                    | ローカル以外でもポートフォワードを行う。                     |
| `-N`                                                    | シェルを開かないようにする。                                 |
| `-f`                                                    | プロセスをバックグラウンドで実行する。                       |
| `-A`                                                    | エージェント転送を行う。<br/>（1つ目のサーバに接続後、続けて別のサーバに接続する際に、最初に使った秘密鍵をそのまま使用する） |

- 入り口・出口のホスト・ポートは、入り口・出口から見たホスト・ポートを指定する。
  （例：出口のホストが`localhost`の場合、それは出口のローカルホストである）

### ホスト認証

- SSHでは、ユーザー名とパスワードによる**ユーザー認証**に先立って、クライアントがサーバの正当性を確認する**ホスト認証**が行われる。
- 初回接続時に、ホストを信頼するかどうかを聞かれる。
- 信頼したホストは、`~/.ssh/known_hosts`ファイルに登録される。

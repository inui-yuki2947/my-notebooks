# その他/Selenium/共通

## 共通

### 参考資料

- [Seleniumブラウザー自動化プロジェクト | Selenium](https://www.selenium.dev/ja/documentation/)

### Selenium IDE

- Selenium IDEは、ブラウザでのアクションを記録する、ブラウザの拡張機能である。

## インストール

### 共通

- インストールには下記が必要。
  - 任意のプログラミング言語のSeleniumライブラリ
  - 任意のブラウザのブラウザドライバ

### Ruby

```bash
gem 'selenium-webdriver'
gem 'webdrivers', '~> 5.0'
```

## 初期化

### 記法

| 記法                                       | 概要                           |
| ------------------------------------------ | ------------------------------ |
| `driver = Selenium::WebDriver.for :chrome` | Chromeのセッションを開始する。 |

## ナビゲート

### 記法

| 記法                                             | 概要                                  |
| ------------------------------------------------ | ------------------------------------- |
| `driver.get(URL)`<br />`driver.navigate.to(URL)` | 指定したURLを開く。（ナビゲートする） |
| `driver.navigate.back`                           | ブラウザの戻るボタンを押す。          |
| `driver.navigate.forward`                        | ブラウザの進むボタンを押す。          |
| `driver.navigate.refresh`                        | 現在のページを更新する。              |

## ブラウザの情報

### 記法

| 記法                 | 概要                     |
| -------------------- | ------------------------ |
| `driver.title`       | 現在のページのタイトル。 |
| `driver.current_url` | 現在のページのURL。      |

## Web要素の検索

### 記法

| 記法                                                         | 概要                                                        |
| ------------------------------------------------------------ | ----------------------------------------------------------- |
| `driver.find_element(引数1, ...)`<br />`DOM要素.find_element(引数1, ...)` | 指定したコンテキストの中で、最初に見つかったDOM要素を返す。 |
| `driver.find_elements(引数1, ...)`<br />`DOM要素.find_elements(引数1, ...)` | 指定したコンテキストの中で、見つかったDOM要素の配列を返す。 |

## Web要素の情報

### 記法

| 記法           | 概要                              |
| -------------- | --------------------------------- |
| `DOM要素.text` | 指定したDOM要素のテキストを返す。 |

## 終了

### 記法

| 記法          | 概要                   |
| ------------- | ---------------------- |
| `driver.quit` | セッションを終了する。 |

## 待機

- ページ遷移した後などで、要素が取得できるまで待ちたい場合は、以下のようにする。
  ただしリダイレクトが行われた場合は、要素取得が中断されるので注意。

  ```ruby
  driver = Selenium::WebDriver.for :firefox
  driver.manage.timeouts.implicit_wait = 10
  driver.find_element(...)
  ```

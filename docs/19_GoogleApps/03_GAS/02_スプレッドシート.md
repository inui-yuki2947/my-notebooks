# GoogleApps/GAS/スプレッドシート

## SpreadsheetApp

### メソッド

| メソッド                 | 戻り値        | 概要                                     |
| ------------------------ | ------------- | ---------------------------------------- |
| `getActiveSpreadsheet()` | `Spreadsheet` | アクティブなスプレッドシートを取得する。 |
| `getActiveSheet()`       | `Sheet`       | アクティブなシートを取得する。           |

## Spreadsheet

### メソッド

| メソッド               | 戻り値    | 概要                             |
| ---------------------- | --------- | -------------------------------- |
| `getSheets`            | `Sheet[]` | シートの一覧を取得する。         |
| `getSheetByName(name)` | `Sheet`   | 指定した名前のシートを取得する。 |

## Sheet

### メソッド（Range取得系）

| メソッド                                         | 戻り値  | 概要                                                         |
| ------------------------------------------------ | ------- | ------------------------------------------------------------ |
| `getDataRange()`                                 | `Range` | シートの全てのRangeを取得する。                              |
| `getRange(row, column, [numRows, [numColumns]])` | `Range` | シートの指定した行・列（・行数・列数）のRangeを取得する。<br />（インデックスは1始まり） |
| `getRange(R1C1形式文字列)`                       | `Range` | シートの指定したRangeを取得する。                            |

### メソッド（その他）

| メソッド          | 戻り値    | 概要                                                 |
| ----------------- | --------- | ---------------------------------------------------- |
| `getFrozenRows()` | `Integer` | シートで固定されている行数を取得する。               |
| `getLastRow()`    | `Integer` | シートで**内容が入っている**最後の行番号を取得する。 |
| `getLastColumn()` | `Integer` | シートで**内容が入っている**最後の列番号を取得する。 |

### 参考資料

- [Class Sheet  |  Apps Script  |  Google Developers](https://developers.google.com/apps-script/reference/spreadsheet/sheet)

## Range

### メソッド（値系）

| メソッド            | 戻り値       | 概要                             |
| ------------------- | ------------ | -------------------------------- |
| `getValue()`        | `Object`     | Rangeの値を取得する。            |
| `getValues()`       | `Object[][]` | Rangeの値の2次元配列を取得する。 |
| `setValue(value)`   | `Range`      | Rangeに値を設定する。            |
| `setValues(values)` | `Range`      | Rangeに値を2次元配列で設定する。 |

### メソッド（数式・A1形式系）

| メソッド                | 戻り値     | 概要                                         |
| ----------------------- | ---------- | -------------------------------------------- |
| `getFormula()`          | `String`   | Rangeの数式（A1形式）を取得する。            |
| `getFormulas()`         | `String[]` | Rangeの数式（A1形式）の2次元配列を取得する。 |
| `setFormula(formula)`   | `Range`    | Rangeに数式（A1形式）を設定する。            |
| `setFormulas(formulas)` | `Range`    | Rangeに数式（A1形式）を2次元配列で設定する。 |

### メソッド（数式・R1C1形式系）

| メソッド                    | 戻り値     | 概要                                           |
| --------------------------- | ---------- | ---------------------------------------------- |
| `getFormulaR1C1()`          | `String`   | Rangeの数式（R1C1形式）を取得する。            |
| `getFormulasR1C1()`         | `String[]` | Rangeの数式（R1C1形式）の2次元配列を取得する。 |
| `setFormulaR1C1(formula)`   | `Range`    | Rangeに数式（R1C1形式）を設定する。            |
| `setFormulasR1C1(formulas)` | `Range`    | Rangeに数式（R1C1形式）を2次元配列で設定する。 |

- 当形式で数式をセットすると、数式のシフトが行われる。

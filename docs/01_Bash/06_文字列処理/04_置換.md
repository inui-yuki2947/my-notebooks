# Bash/文字列処理/置換

## tr

### コマンド

| コマンド           | 概要                                                | 例           |
| ------------------ | --------------------------------------------------- | ------------ |
| `tr 置換前 置換後` | 文字を**一文字ずつ**置換する。                      | `tr A-Z a-z` |
| `tr -d 文字`       | 文字を削除する。                                    |              |
| `tr -s 文字`       | 文字が連続していた場合1つにまとめる。               |              |
| `tr -ds 文字`      | 文字が連続していた場合1つにまとめ、文字を削除する。 |              |

### 文字クラス

| 文字クラス  | 概要     |
| ----------- | -------- |
| `[:alpha:]` | 英字     |
| `[:lower:]` | 英小文字 |
| `[:upper:]` | 英大文字 |
| `[:digit:]` | 数字     |
| `[:alnum:]` | 英数字   |

## sed

### コマンド

| コマンド                     | 概要                           |
|--------------------------|------------------------------|
| `sed スクリプトコマンド`          | 標準入力に対して、スクリプトの処理を行う。        |
| `sed スクリプトコマンド ファイル名...` | 指定した全てのファイルに対して、スクリプトの処理を行う。 |

- スクリプトコマンドは、`スクリプトコマンド1[;スクリプトコマンド2;...]`の形式で複数指定できる。
- 標準入力・ファイル内容が空の場合は、何も処理がなされない。

### オプション

| オプション                                  | 概要                                                         |
| ------------------------------------------- | ------------------------------------------------------------ |
| `-e スクリプトコマンド`                     | スクリプトコマンドを追加で指定する。                         |
| `-r`（GNU）<br />`-E`（BSD）                | 拡張正規表現を使用する。                                     |
| `-i[拡張子]`（GNU）<br />`-i 拡張子`（BSD） | 引数の拡張子でバックアップを取り、ファイルの上書きを行う。<br /><https://it-ojisan.tokyo/mac-linux-sed/> |
| `-n, --quiet, --silent`                     | 出力コマンド以外の出力を行わない。                           |
| `-z`                                        | 改行コードを操作する。                                       |

## スクリプトコマンド

### スクリプトコマンド

| スクリプトコマンド   | 概要                                                 | 例            |
| -------------------- | ---------------------------------------------------- | ------------- |
| `コマンド`           | 全ての行に対して、コマンドを実行する。               | `i hoge`      |
| `nコマンド`          | n行目に対して、コマンドを実行する。                  | `1i hoge`     |
| `m,nコマンド`        | mからn行目に対して、コマンドを実行する。             | `1,3i hoge`   |
| `$コマンド`          | 最終行に対して、コマンドを実行する。                 | `$i hoge`     |
| `/正規表現/コマンド` | 正規表現に当てはまる行に対して、コマンドを実行する。 | `/#.*/i hoge` |

### コマンド

| コマンド                    | 概要                                                         |
| --------------------------- | ------------------------------------------------------------ |
| `i 文字列` ※1,2             | 指定した行の**前に**文字列を追加する。                       |
| `a 文字列` ※1,2             | 指定した行の**後ろに**文字列を追加する。                     |
| `c 文字列` ※1,2             | 指定した行を**文字列で置換する**。                           |
| `d`                         | 指定した行を削除する。                                       |
| `p`                         | 指定した行を出力する。                                       |
| `=`                         | 指定した行の行番号を出力する。                               |
| `y/置換前/置換後/` ※3       | 置換前を置換後の**同じ位置の文字**に置換する。               |
| `s/置換前/置換後/フラグ` ※3 | 置換前を置換後に置換する。<br /> `&`で文字列全体、`\1, \2, ...`で括弧で囲んだ部分の後方参照／後方置換ができる。 <br />最短一致は使えないので、代わりにクラスの否定を使う。 |

- ※1 BSDでは、文字列を改行して入力する必要がある。
- ※2 空白から始まる文字列を指定したい場合は、先頭にバッククォートを付ける。
- ※3 `y, s`の次の任意の文字がデリミタとなる。（例：`s@置換前@置換後@`）
- コマンド文字列内で変数展開を行う場合、変数内に改行を含むことはできない。（ベタ書きで改行文字を含むことはできる）
    [sedコマンド](https://www.yutry.net/pc/program/sed-shellscript#mulchline-sed-insert)

### フラグ

| フラグ | 概要                    |
| ------ | ----------------------- |
| `g`    | 1行で複数回置換を行う。 |
| `p`    | 出力を行う。            |

# Bash/文法/標準入出力

## 共通

### ファイルディスクリプタ

| ファイルディスクリプタ | 概要           |
| ---------------------- | -------------- |
| `0`                    | 標準入力       |
| `1`                    | 標準出力       |
| `2`                    | 標準エラー出力 |

## リダイレクト

### 書式

| 書式               | 概要                                                         |
| ------------------ | ------------------------------------------------------------ |
| `< ファイル名`     | 指定したファイルの内容を、<br />標準入力にする。             |
| `[n]> ファイル名`  | n番のファイルディスクリプタ（省略時は1番＝標準出力）を、<br />指定したファイルに**上書き**する。 |
| `[n]>> ファイル名` | n番のファイルディスクリプタ（省略時は1番＝標準出力）を、<br />指定したファイルに**追記**する。 |
| `&> ファイル名`    | 1番・2番のファイルディスクリプタ（標準出力・標準エラー出力）を、<br />指定したファイルに**上書き**する。（使えない環境もある） |
| `&>> ファイル名`   | 1番・2番のファイルディスクリプタ（標準出力・標準エラー出力）を、<br />指定したファイルに**追記**する。（使えない環境もある） |
| `[n]>&m`           | n番のファイルディスクリプタ（省略時は1番＝標準出力）を、<br />m番のファイルディスクリプタにする。 |

- リダイレクトはコマンドの後に複数指定可能であり、それは記述した順に行われる。（順不同ではない）
- 上書き時は、ファイルの内容を空にしてから処理が行われるため、**同じファイルを読み込みつつ上書きはできない。**
  同一ファイルを読み込みつつ書き込みたい場合は、一時ファイルなどを使用するのがよい。
  [Bashで読み込んだファイルに対して、リダイレクトで上書きするとファイルが空になる問題への対処 | ゲンゾウ用ポストイット](https://genzouw.com/entry/2022/07/30/080038/3043/)

### 例

| 書式                                                       | 概要                                                         |
| ---------------------------------------------------------- | ------------------------------------------------------------ |
| `コマンド 2>&1`                                            | 標準エラー出力を、標準出力に出力する。                       |
| `コマンド 2>&1 > sample.txt`                               | 標準エラー出力を標準出力に出力し、標準出力を`sample.txt`に出力する |
| `コマンド > sample.txt 2>&1`<br />`コマンド &> sample.txt` | 標準出力・エラー出力を、まとめて`sample.txt`に出力する       |

## パイプライン

### コマンド

| コマンド                                                     | 概要                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `コマンド1 ｜ コマンド2`                                     | コマンド1の標準出力を、コマンド2の標準入力にする。           |
| `コマンド1 2>&1 ｜ コマンド2`<br />`コマンド1 ｜& コマンド2` ※1 | コマンド1の標準出力・エラー出力を、コマンド2の標準入力にする。 |

- ※1 BSDでは使えない？
- パイプラインでつないだコマンドは、サブシェルで実行される。

## ヒアドキュメント・ヒアストリング

### コマンド

| コマンド              | 概要                                                         |
| --------------------- | ------------------------------------------------------------ |
| 書式1                 | 指定した文字列を、コマンドの標準入力にする。（ヒアドキュメント） |
| `コマンド <<< 文字列` | 指定した文字列を、コマンドの標準入力にする。（ヒアストリング）<br />`sh`ではサポートされていない？ |

- 書式1

  ```bash
  コマンド << 終了文字列
  文字列
  ...
  終了文字列
  ```

- ヒアドキュメントの内側では各種展開が行われるが、
  展開をさせたくない場合は、`<< 'EOF'`や`<< \EOF`などとクォートする。

### 例

```bash
cat << EOF
あいうえお
かきくけこ
EOF
```

## グループコマンド

### コマンド

| 書式                                | 概要                                                         |
| ----------------------------------- | ------------------------------------------------------------ |
| `{ コマンド1 ; コマンド2 ; ... ; }` | **カレントシェル**で、複数のコマンドを実行し、まとめて標準出力する。 |
| `( コマンド1 ; コマンド2 ; ... )`   | **サブシェル**で、複数のコマンドを実行し、まとめて標準出力する。 |

### その他

- サブシェルでは、シェル変数・環境変数は引き継がれるが、サブシェル内での変更は反映されない。

## その他

### ハイフン

- `cat, diff, vim, wget`コマンドで、`-`を引数に渡すと、標準入出力として扱われる。
  [git, cd, su, cat, diff, vim...-(ハイフン)でできること@コマンドライン - Qiita](https://qiita.com/ryosukes/items/b9a3b2913f72e1127e58#cat-diff-vim-wget%E3%81%A7%E3%83%8F%E3%82%A4%E3%83%95%E3%83%B3%E3%82%92%E5%BC%95%E6%95%B0%E3%81%AB%E6%B8%A1%E3%81%99%E3%81%A8)

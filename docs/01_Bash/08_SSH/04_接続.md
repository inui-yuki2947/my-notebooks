# Bash/SSH/接続

## ssh

### コマンド

| コマンド              | 概要                            |
| --------------------- | ------------------------------- |
| `ssh 接続名`          | SSH接続する。                   |
| `ssh 接続名 コマンド` | SSH接続し、コマンドを実行する。 |

### 接続名

| 接続名                | 概要                                                     |
| --------------------- | -------------------------------------------------------- |
| `ホスト名`            | ローカルと同名のユーザー名、指定したホスト名で接続する。 |
| `ユーザー名@ホスト名` | 指定したユーザー名・ホスト名で接続する。                 |
| `任意の名前`          | 設定ファイルに記述された情報で接続する。                 |

### オプション

| 分類             | オプション                                              | 概要                                                         |
| ---------------- | ------------------------------------------------------- | ------------------------------------------------------------ |
| 基本             | `-i 秘密鍵ファイル`                                     | 使用する秘密鍵ファイルを指定する。                           |
| 基本             | `-p ポート番号`                                         | ポート番号を指定する。                                       |
| 基本             | `-t`                                                    | 仮想端末を割り当てる。                                       |
| 基本             | `-v, --verbose`                                         | 冗長な情報（実行SQLなど）を出力する。<br />複数回指定すると更に冗長になる。 |
| ポートフォワード | `-L ローカルのポート:リモートのホスト:リモートのポート` | ローカルフォワードを行う。（入り口がローカル、出口がリモート） |
| ポートフォワード | `-R リモートのポート:ローカルのホスト:ローカルのポート` | リモートフォワードを行う。（入り口がリモート、出口がローカル） |
| ポートフォワード | `-g`                                                    | ローカル以外でもポートフォワードを行う。                     |
| ポートフォワード | `-N`                                                    | シェルを開かないようにする。                                 |
| ポートフォワード | `-f`                                                    | プロセスをバックグラウンドで実行する。                       |
| ポートフォワード | `-A`                                                    | エージェント転送を行う。<br/>（1つ目のサーバに接続後、続けて別のサーバに接続する際に、最初に使った秘密鍵をそのまま使用する） |

- 入り口・出口のホスト・ポートは、入り口・出口から見たホスト・ポートを指定する。
  （例：出口のホストが`localhost`の場合、それは出口のローカルホストである）

## autossh

### コマンド

| コマンド         | 概要                                    |
| ---------------- | --------------------------------------- |
| `autossh 接続名` | 自動で再接続を行うように、SSH接続する。 |

## ssh-agent

### 概要

- ssh-agentは、パスフレーズの入力を代わりに行う。

### コマンド

| コマンド                 | 概要                                   |
| ------------------------ | -------------------------------------- |
| `ssh-agent bash`         | ssh-agentを起動する。                  |
| `ssh-add 秘密鍵ファイル` | 秘密鍵を登録する。                     |
| `ssh-add -l`             | 登録されている秘密鍵の一覧を表示する。 |

### 参考資料

- [【SSH】ssh-agent の使い方 – ラボラジアン](https://laboradian.com/how-to-use-ssh-agent/)

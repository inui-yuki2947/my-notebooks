# Bash/SSH/クライアント側設定

## ssh-keygen

### コマンド

| コマンド     | 概要                                       |
| ------------ | ------------------------------------------ |
| `ssh-keygen` | 公開鍵と秘密鍵のペアを、対話的に作成する。 |

### オプション（鍵生成系）

| オプション      | 概要                                                         |
| --------------- | ------------------------------------------------------------ |
| `-f ファイル名` | 生成先のファイルパスを指定する。（デフォルトは`~/.ssh/id_rsa`及び`~/.ssh/id_rsa.pub`） |
| `-p`            | パスフレーズを変更する。                                     |
| `-t 暗号化形式` | 暗号化形式を指定できる。（デフォルトは`rsa`）                |
| `-C コメント`   | コメントを指定できる。（デフォルトは`ユーザ名@ホスト名`）    |

### オプション（known_hosts系）

| オプション    | 概要                                     |
| ------------- | ---------------------------------------- |
| `-R ホスト名` | 指定したホストに属する鍵を全て取り除く。 |

## 秘密鍵・公開鍵

### ファイル

| ファイル            | 概要                                                         |
| ------------------- | ------------------------------------------------------------ |
| `~/.ssh/id_rsa`     | 秘密鍵がデフォルトで配置されるパス。<br />パーミッションは`600`にしておかないとエラーが出る。 |
| `~/.ssh/id_rsa.pub` | 公開鍵がデフォルトで配置されるパス。                         |

## ~/.ssh/config

### ファイル

| ファイル              | 概要                                          |
| --------------------- | --------------------------------------------- |
| `/etc/ssh/ssh_config` | SSHクライアントの設定を行う。（システム全体） |
| `~/.ssh/config`       | SSHクライアントの設定を行う。（ユーザー固有） |

### 書式

```text
Host 接続名
  HostName ホスト名
  User ユーザー名
  Port ポート番号
  IdentityFile 公開鍵ファイル
```

- `IdentityFileの値`、`IdentityFileの値.pub`は、各コマンドでのデフォルトの秘密鍵・公開鍵ファイルとなる。
  （通常は、`~/.ssh/id_rsa`, `~/.ssh/id_rsa.pub`）

## ホスト認証

### 概要

- SSHでは、ユーザー名とパスワードによる**ユーザー認証**に先立って、クライアントがサーバの正当性を確認する**ホスト認証**が行われる。
- 初回接続時に、ホストを信頼するかどうかを聞かれる。

### ファイル

| ファイル             | 概要                                 |
| -------------------- | ------------------------------------ |
| `~/.ssh/known_hosts` | 信頼したホストが記述されるファイル。 |

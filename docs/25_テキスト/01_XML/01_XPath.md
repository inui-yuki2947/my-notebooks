# テキスト/XML/XPath

## 共通

### コンテキストノード

- 「コンテキストノード」とは、現在の基準点となるノードである。

### ロケーションパス

- ロケーションパスは、ロケーションステップを`/`などで区切って表したものである。

| 記法           | 概要                     |
| -------------- | ------------------------ |
| `/`            | ルート要素。             |
| `//`           | 任意の要素。             |
| `要素1/要素2`  | 要素1の直下にある要素2。 |
| `要素1//要素2` | 要素1の子孫である要素2。 |

### ロケーションステップ

- ロケーションステップは、`軸::ノードテスト[述語1][述語2]...`の形式で表される。
  （軸・述語は省略可能）

### 軸

| 記法                 | 概要                                             |
| -------------------- | ------------------------------------------------ |
| `child`              | コンテキストノードの子。（未指定時のデフォルト） |
| `descendant`         | コンテキストノードの子孫。                       |
| `descendant-or-self` | コンテキストノード及びその子孫。                 |
| `parent`             | コンテキストノードの親。                         |
| `self`               | コンテキストノード。                             |
| `attribute`          | コンテキストノードの属性。                       |

### ノードテスト

| 記法     | 概要                   |
| -------- | ---------------------- |
| `要素名` | 要素名が等しいノード。 |
| `*`      | 任意のノード。         |
| `node()` | 任意のノード。         |

### 述語

| 記法           | 概要                                          |
| -------------- | --------------------------------------------- |
| `要素`         | 指定した要素を含むもの。                      |
| `@属性名`      | 指定した属性を含むもの。                      |
| `n`            | n番目であるもの。（`position() = n`の省略形） |
| `任意の真偽値` | 指定した真偽値を満たすもの。                  |

### 省略形

| 記法         | 概要                                                         |
| ------------ | ------------------------------------------------------------ |
| 軸の指定なし | ノードテストに `attribute()`が指定される場合は、`attribute::`の省略形。<br />それ以外は、`child::`の省略形。 |
| `@`          | `attribute::`の省略形。                                      |
| `//`         | `/descendant-or-self::node()/`の省略形                       |
| `..`         | `parent::node()`の省略形。                                   |

## その他

### 関数

| 記法                       | 概要                                                |
| -------------------------- | --------------------------------------------------- |
| `text()`                   | 当該要素のテキスト。                                |
| `position()`               | 当該要素が何番目であるか。（インデックスは1始まり） |
| `contains(対象, 検索対象)` | 対象に検索対象が含まれるかどうか。                  |

### 演算子

| 記法              | 概要         |
| ----------------- | ------------ |
| `not 条件`        | 条件の否定。 |
| `条件1 and 条件2` | AND条件。    |
| `条件1 or 条件2`  | OR条件。     |

### その他

| 記法                       | 概要     |
| -------------------------- | -------- |
| `"文字列"`<br />`'文字列'` | 文字列。 |

## 参考資料

- [XPath | MDN](https://developer.mozilla.org/ja/docs/Web/XPath)
- [XPath の概要 - IBM Documentation](https://www.ibm.com/docs/ja/i/7.2?topic=programming-overview-xpath)
- [XPath | TECHSCORE(テックスコア)](https://www.techscore.com/tech/XML/XPath/)
- [クローラ作成に必須！XPATHの記法まとめ - Qiita](https://qiita.com/rllllho/items/cb1187cec0fb17fc650a)

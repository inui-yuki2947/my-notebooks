# ファイル所有者・権限

## 所有者

### chown, chgrp

- コマンド

  |コマンド|概要|
  |---|---|
  |`chown 新しい所有者[:新しい所有グループ] ファイル名...`|ファイルの所有者・所有グループを変更する。|
  |`chgrp 新しい所有グループ ファイル名...`|ファイルの所有グループを変更する。<br />一般ユーザーは、変更前後のグループ両方に属している場合のみ変更できる。|

- オプション（`chown`）

  |オプション|概要|
  |---|---|
  |`-R`|指定したディレクトリ及びその中のファイル全てを対象とする。|

## ファイル権限

### 概要

- ディレクトリの権限

  | 権限         | 概要                                               | 使用可能になるコマンド例 |
  | ------------ | -------------------------------------------------- | ------------------------ |
  | 読み取り権限 | ディレクトリ内の内容を参照できる。                 | `ls`, `find`             |
  | 書き込み権限 | ディレクトリ内ファイルの作成・変更・削除ができる。 | `touch`, `mv`, `rm`      |
  | 実行権限     | ディレクトリへの移動ができる。                     | `cd`                     |

  - 読み取り・実行権限があると、IntelliJでディレクトリ内ファイルが表示される。

- 特殊な権限

  | 権限                 | 概要                                                         | アルファベット表記 | 数値表記 |
  | -------------------- | ------------------------------------------------------------ | ------------------ | -------- |
  | SUID（Set User ID）  | ファイル実行時、所有者の権限で実行される。                   | `u+s`              | `4000`   |
  | SGID（Set Group ID） | ファイル実行時、所有グループの権限で実行される。             | `g+s`              | `2000`   |
  | スティッキービット   | 所有者とrootユーザーのみ、ファイルのリネームや削除ができる。 | `o+t`              | `1000`   |

### chmod

- コマンド

  |コマンド|概要|例|
  |---|---|---|
  |`chmod <所有者の権限><グループの権限><その他ユーザーの権限> ファイル名`|ファイルの権限を変更する。|`chmod 744 ファイル名`|
  |`chmod [対象]<=,+,-,><許可の種別>[,...] ファイル名`|ファイルの権限を変更する。|`chmod g+x ファイル名`<br />`chmod g+x,o+x ファイル名`|

- 対象を`a`とするか指定しなかった場合は、全てが対象となる。

## ユーザー切り替え

### su

- コマンド

  |コマンド|概要|
  |---|---|
  |`su [ユーザー（省略時はroot）]`|ユーザーを切り替える。|

- オプション

  |オプション|概要|
  |---|---|
  |`-, -l`|シェルをログインシェルにする。（カレントディレクトリや環境変数を初期化する）|

- 当コマンド実行後、**切り替え先ユーザー**のパスワードが求められる。

- `exit`コマンドで、元のユーザーに戻ることができる。

### sudo

- コマンド

  |コマンド|概要|
  |---|---|
  |`sudo [コマンド]`|rootユーザーの権限でコマンドを実行する。|

- オプション

  |オプション|概要|
  |---|---|
  |`-l`|自分に許可されているコマンド一覧を表示する。|

- 当コマンド実行後、**今のユーザー**のパスワードが求められる。

- `sudo`コマンドを使うと、`/var/log/secure`にログが残る。

### /etc/sudoers

- `/etc/sudoers`ファイルには、sudoの権限を記述する。

  ```text
  ユーザー名 ホスト名=(実行ユーザー名) [NOPASSWORD:] コマンド
  ```

- 例

  ```text
  student ALL=(ALL) /sbin/shutdown
  ```

- `NOPASSWORD:`を指定すると、実行時にパスワードを問われない。

- コマンド

  |コマンド|概要|
  |---|---|
  |`visudo`|`/etc/sudoers`ファイルを安全に編集する。|

## その他

### umask

- コマンド

  |コマンド|概要|
  |---|---|
  |`umask マスク値`|umask値の設定を行う。|

- ファイルは`666`から、ディレクトリは`777`からumask値を引いた値が、デフォルトのアクセス権として設定される。
- umask値のデフォルトは、CentOSは`002`、Ubuntu, Macは`022`である。

### ulimit

- コマンド

  |コマンド|概要|
  |---|---|
  |`ulimit [値]`|ユーザーが利用できるリソースを管理する。|

- オプション

  | オプション | 概要                             |
  | ---------- | -------------------------------- |
  | `-a`       | 設定値を全て表示する。           |
  | `-c`       | コアファイルのサイズを制限する。 |
  | `-f`       | 出力ファイルのサイズを制限する。 |
